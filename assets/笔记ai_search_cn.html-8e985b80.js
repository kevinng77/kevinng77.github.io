import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as r,c,a as s,b as n,d as e,f as l}from"./app-e8d04472.js";const t={},i=s("h1",{id:"azure-ai-search",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#azure-ai-search","aria-hidden":"true"},"#"),n(" Azure AI Search")],-1),d=s("p",null,'Azure AI Search formerly known as "Azure Cognitive Search"',-1),y={href:"https://learn.microsoft.com/en-us/python/api/overview/azure/search-documents-readme?view=azure-python",target:"_blank",rel:"noopener noreferrer"},u={href:"https://azuresdkdocs.blob.core.windows.net/$web/python/azure-search-documents/latest/index.html",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/Azure/azure-sdk-for-python/tree/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples",target:"_blank",rel:"noopener noreferrer"},m=l('<h2 id="_0-概念概述" tabindex="-1"><a class="header-anchor" href="#_0-概念概述" aria-hidden="true">#</a> 0. 概念概述</h2><h3 id="_0-1-关键概念" tabindex="-1"><a class="header-anchor" href="#_0-1-关键概念" aria-hidden="true">#</a> 0.1 关键概念</h3><ul><li><strong>Data Source</strong> : 持久化源数据连接信息，包括凭证。数据源对象专门用于索引器。.</li><li><strong>Index</strong> : 用于全文搜索和其他查询的物理数据结构。</li><li><strong>Indexer</strong> : 配置对象，指定数据源、目标索引、可选的 AI 技能集、可选的调度，以及错误处理和 base-64 编码的可选配置设置。</li><li><strong>Skillset</strong> : 操作、转换和整理内容的完整指令集，包括从图像文件中分析和提取信息。除了非常简单和有限的结构外，它包括对提供增强的 Azure AI 服务资源的引用。</li><li><strong>Knowledge store</strong> : 在 Azure 存储的表和 blob 中存储来自 AI 增强管道的输出，以便独立分析或下游处理。</li></ul><h3 id="_0-2-关键类" tabindex="-1"><a class="header-anchor" href="#_0-2-关键类" aria-hidden="true">#</a> 0.2 关键类</h3>',4),h=s("code",null,"SearchClient",-1),E={href:"https://docs.microsoft.com/azure/search/search-lucene-query-architecture",target:"_blank",rel:"noopener noreferrer"},b={href:"https://docs.microsoft.com/azure/search/search-query-overview",target:"_blank",rel:"noopener noreferrer"},_={href:"https://docs.microsoft.com/azure/search/search-filters",target:"_blank",rel:"noopener noreferrer"},f={href:"https://docs.microsoft.com/rest/api/searchservice/autocomplete",target:"_blank",rel:"noopener noreferrer"},A={href:"https://docs.microsoft.com/rest/api/searchservice/suggestions",target:"_blank",rel:"noopener noreferrer"},D={href:"https://docs.microsoft.com/rest/api/searchservice/addupdate-or-delete-documents",target:"_blank",rel:"noopener noreferrer"},g=s("code",null,"SearchIndexClient",-1),q={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/azure/search/documents/indexes/_search_index_client.py#L31",target:"_blank",rel:"noopener noreferrer"},x={href:"https://docs.microsoft.com/rest/api/searchservice/index-operations",target:"_blank",rel:"noopener noreferrer"},C={href:"https://docs.microsoft.com/rest/api/searchservice/synonym-map-operations",target:"_blank",rel:"noopener noreferrer"},F=s("li",null,"Analyze text 分析文本",-1),z=s("code",null,"SearchIndexerClient",-1),S={href:"https://docs.microsoft.com/rest/api/searchservice/indexer-operations",target:"_blank",rel:"noopener noreferrer"},k={href:"https://docs.microsoft.com/rest/api/searchservice/skillset-operations",target:"_blank",rel:"noopener noreferrer"},I=l(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">azure-search-documents</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="快速概述" tabindex="-1"><a class="header-anchor" href="#快速概述" aria-hidden="true">#</a> 快速概述</h1><h3 id="_1-在-azure-门户上创建-ai-搜索服务" tabindex="-1"><a class="header-anchor" href="#_1-在-azure-门户上创建-ai-搜索服务" aria-hidden="true">#</a> 1. 在 Azure 门户上创建 AI 搜索服务</h3>`,3),w={href:"https://learn.microsoft.com/en-us/azure/search/search-create-service-portal",target:"_blank",rel:"noopener noreferrer"},T={href:"https://learn.microsoft.com/en-us/azure/search/search-manage-powershell#create-or-delete-a-service",target:"_blank",rel:"noopener noreferrer"},K={href:"https://learn.microsoft.com/en-us/cli/azure/search/service?view=azure-cli-latest#az-search-service-create",target:"_blank",rel:"noopener noreferrer"},P=l(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.core.credentials </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> AzureKeyCredential</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> SearchClient</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes.models </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    SimpleField,</span></span>
<span class="line"><span style="color:#24292E;">    SearchFieldDataType,</span></span>
<span class="line"><span style="color:#24292E;">    SearchableField,</span></span>
<span class="line"><span style="color:#24292E;">    ComplexField,</span></span>
<span class="line"><span style="color:#24292E;">    CorsOptions,</span></span>
<span class="line"><span style="color:#24292E;">    ScoringProfile,</span></span>
<span class="line"><span style="color:#24292E;">    SearchIndex,</span></span>
<span class="line"><span style="color:#24292E;">    SearchField,</span></span>
<span class="line"><span style="color:#24292E;">    VectorSearch,</span></span>
<span class="line"><span style="color:#24292E;">    HnswAlgorithmConfiguration,</span></span>
<span class="line"><span style="color:#24292E;">    VectorSearchAlgorithmKind,</span></span>
<span class="line"><span style="color:#24292E;">    HnswParameters,</span></span>
<span class="line"><span style="color:#24292E;">    VectorSearchProfile,</span></span>
<span class="line"><span style="color:#24292E;">    VectorSearchAlgorithmMetric,</span></span>
<span class="line"><span style="color:#24292E;">    ExhaustiveKnnAlgorithmConfiguration,</span></span>
<span class="line"><span style="color:#24292E;">    ExhaustiveKnnParameters,</span></span>
<span class="line"><span style="color:#24292E;">    SemanticConfiguration,</span></span>
<span class="line"><span style="color:#24292E;">    SemanticField,</span></span>
<span class="line"><span style="color:#24292E;">    SemanticSearch,</span></span>
<span class="line"><span style="color:#24292E;">    SemanticPrioritizedFields,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">service_endpoint </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># Your Azure AI Search Endpoint (The Azure AI Search URL)</span></span>
<span class="line"><span style="color:#24292E;">key </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># Your Azure AI Search Key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">index_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;kevin_tests&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-创建索引" tabindex="-1"><a class="header-anchor" href="#_2-创建索引" aria-hidden="true">#</a> 2. 创建索引</h3><p>在 Azure AI 搜索中，索引是用于启用搜索功能的 JSON 文档和其他内容的持久集合。</p><p>Azure AI 搜索需要知道你希望如何搜索和显示文档中的字段。你可以通过为这些字段分配属性或行为来指定这一点。对于文档中的每个字段，索引存储其名称、数据类型和支持字段的行为，例如字段是否可搜索、字段是否可以排序？</p><p>最高效的索引仅使用所需的行为。如果在设计时忘记设置字段上的必要行为，获取该功能的唯一方法是重建索引。</p>`,5),V={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples/sample_index_crud_operations.py",target:"_blank",rel:"noopener noreferrer"},N=l(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">## create index</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> SearchIndexClient</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> typing </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> List</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexClient(service_endpoint, AzureKeyCredential(key))</span></span>
<span class="line"><span style="color:#24292E;">fields </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">    SimpleField(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;hotelId&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.String, </span><span style="color:#E36209;">key</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    SimpleField(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;baseRate&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.Double),</span></span>
<span class="line"><span style="color:#24292E;">    SearchableField(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;description&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.String, </span><span style="color:#E36209;">collection</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span></span>
<span class="line"><span style="color:#24292E;">    ),</span></span>
<span class="line"><span style="color:#24292E;">    SearchableField(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.String, </span><span style="color:#E36209;">collection</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    SearchField(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;vector&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.Collection(SearchFieldDataType.Single),</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">searchable</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">vector_search_dimensions</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">vector_search_profile_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myHnswProfile&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    ),</span></span>
<span class="line"><span style="color:#24292E;">    ComplexField(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;address&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">            SimpleField(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;streetAddress&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.String),</span></span>
<span class="line"><span style="color:#24292E;">            SimpleField(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;city&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SearchFieldDataType.String),</span></span>
<span class="line"><span style="color:#24292E;">        ],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">collection</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    ),</span></span>
<span class="line"><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Vector Search Reference:</span></span>
<span class="line"><span style="color:#6A737D;"># 1. https://learn.microsoft.com/en-us/azure/search/vector-search-overview</span></span>
<span class="line"><span style="color:#6A737D;"># 2. https://learn.microsoft.com/en-us/azure/search/vector-search-ranking</span></span>
<span class="line"><span style="color:#24292E;">vector_search </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> VectorSearch(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">algorithms</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">        HnswAlgorithmConfiguration(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myHnsw&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">kind</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">VectorSearchAlgorithmKind.</span><span style="color:#005CC5;">HNSW</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">parameters</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">HnswParameters(</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#E36209;">m</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#E36209;">ef_construction</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">400</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#E36209;">ef_search</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">500</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#E36209;">metric</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">VectorSearchAlgorithmMetric.</span><span style="color:#005CC5;">COSINE</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            ),</span></span>
<span class="line"><span style="color:#24292E;">        ),</span></span>
<span class="line"><span style="color:#24292E;">        ExhaustiveKnnAlgorithmConfiguration(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myExhaustiveKnn&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">kind</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">VectorSearchAlgorithmKind.</span><span style="color:#005CC5;">EXHAUSTIVE_KNN</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">parameters</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">ExhaustiveKnnParameters(</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#E36209;">metric</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">VectorSearchAlgorithmMetric.</span><span style="color:#005CC5;">COSINE</span></span>
<span class="line"><span style="color:#24292E;">            ),</span></span>
<span class="line"><span style="color:#24292E;">        ),</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">profiles</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">        VectorSearchProfile(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myHnswProfile&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">algorithm_configuration_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myHnsw&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        ),</span></span>
<span class="line"><span style="color:#24292E;">        VectorSearchProfile(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myExhaustiveKnnProfile&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">algorithm_configuration_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;myExhaustiveKnn&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        ),</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Semantic Search Reference:</span></span>
<span class="line"><span style="color:#6A737D;"># 1. https://learn.microsoft.com/en-us/azure/search/semantic-search-overview</span></span>
<span class="line"><span style="color:#24292E;">semantic_config </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SemanticConfiguration(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;adp-test-semantic-config&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">prioritized_fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SemanticPrioritizedFields(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">title_field</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">SemanticField(</span><span style="color:#E36209;">field_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">keywords_fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">            SemanticField(</span><span style="color:#E36209;">field_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;filename&quot;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">            SemanticField(</span><span style="color:#E36209;">field_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">            SemanticField(</span><span style="color:#E36209;">field_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;headings&quot;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">        ],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">content_fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[SemanticField(</span><span style="color:#E36209;">field_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">)],</span></span>
<span class="line"><span style="color:#24292E;">    ),</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">semantic_search </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SemanticSearch(</span><span style="color:#E36209;">configurations</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[semantic_config])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">cors_options </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> CorsOptions(</span><span style="color:#E36209;">allowed_origins</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;*&quot;</span><span style="color:#24292E;">], </span><span style="color:#E36209;">max_age_in_seconds</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">60</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">scoring_profiles: List[ScoringProfile] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []  </span><span style="color:#6A737D;"># Config Profile Score, Default tf-idf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">index </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndex(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">index_name,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">fields,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">scoring_profiles</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">scoring_profiles,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">cors_options</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">cors_options,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">vector_search</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">vector_search,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># semantic_search=semantic_search,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">exist_index_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [x.name </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> x </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> client.list_indexes()]</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> index_name </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> exist_index_name:</span></span>
<span class="line"><span style="color:#24292E;">    result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.create_or_update_index(index)</span></span>
<span class="line"><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Index Name </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">index_name</span><span style="color:#005CC5;">}</span><span style="color:#032F62;"> Already Exist&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;"># result</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-上传文档" tabindex="-1"><a class="header-anchor" href="#_3-上传文档" aria-hidden="true">#</a> 3. 上传文档</h3>`,2),R={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples/sample_crud_operations.py",target:"_blank",rel:"noopener noreferrer"},H=l(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">search_client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchClient(service_endpoint, index_name, AzureKeyCredential(key))</span></span>
<span class="line"><span style="color:#005CC5;">DOCUMENT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;hotelId&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1000&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;baseRate&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">4.0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;description&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;A sample Document&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;A sample Document&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;address&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;Chaim Time&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Shanghai&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;vector&quot;</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2.0</span><span style="color:#24292E;">],  </span><span style="color:#6A737D;"># Dummy vector - replace with your embedding</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;hotelId&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1001&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;baseRate&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">13.0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;description&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;hello world&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;hotel2&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;address&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;Chaim Time&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Shanghai&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;vector&quot;</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">10.0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">20.0</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;hotelId&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1002&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;baseRate&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">13.0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;description&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;hello world2&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;title&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;hotel2&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;address&quot;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;Chaim Time&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Shanghai&quot;</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;vector&quot;</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2.0</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> search_client.upload_documents(</span><span style="color:#E36209;">documents</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">DOCUMENT</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Upload of new document succeeded: </span><span style="color:#005CC5;">{}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">.format(result[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].succeeded))</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-搜索" tabindex="-1"><a class="header-anchor" href="#_4-搜索" aria-hidden="true">#</a> 4. 搜索</h3><p>参考:</p>`,3),O={href:"https://learn.microsoft.com/en-us/azure/search/hybrid-search-overview",target:"_blank",rel:"noopener noreferrer"},L={href:"https://learn.microsoft.com/en-us/azure/search/search-lucene-query-architecture",target:"_blank",rel:"noopener noreferrer"},B={href:"https://learn.microsoft.com/en-us/azure/search/vector-search-overview",target:"_blank",rel:"noopener noreferrer"},M=l(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">### text search</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.models </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> VectorizedQuery</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">search_client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchClient(service_endpoint, index_name, AzureKeyCredential(key))</span></span>
<span class="line"><span style="color:#24292E;">vector_query </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> VectorizedQuery(</span><span style="color:#E36209;">vector</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#E36209;">k_nearest_neighbors</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fields</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;vector&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">results </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> search_client.search(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">search_text</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;hotel2&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">search_fields</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;description&quot;</span><span style="color:#24292E;">], </span><span style="color:#E36209;">vector_queries</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[vector_query]</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> result </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> results:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(result)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-1-full-text-search" tabindex="-1"><a class="header-anchor" href="#_4-1-full-text-search" aria-hidden="true">#</a> 4.1 Full Text Search</h4>`,2),U=s("li",null,"用 Analyser 分析器对文档进行分词。",-1),Q={href:"https://learn.microsoft.com/en-us/azure/search/search-lucene-query-architecture#stage-3-document-retrieval",target:"_blank",rel:"noopener noreferrer"},W={href:"https://learn.microsoft.com/en-us/azure/search/search-lucene-query-architecture#stage-4-scoring",target:"_blank",rel:"noopener noreferrer"},Y=s("code",null,"scoring_profiles",-1),J=s("h4",{id:"_4-2-向量搜索",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-2-向量搜索","aria-hidden":"true"},"#"),n(" 4.2 向量搜索")],-1),X=s("p",null,"当前支持 HNSW 和 KNN。",-1),$=s("h4",{id:"_4-3-hybird-search",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-3-hybird-search","aria-hidden":"true"},"#"),n(" 4.3 Hybird Search")],-1),j=s("li",null,"单个查询请求包含搜索和向量查询参数",-1),G=s("li",null,"并行执行",-1),Z={href:"https://learn.microsoft.com/en-us/azure/search/hybrid-search-ranking",target:"_blank",rel:"noopener noreferrer"},ss={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/rrf.html",target:"_blank",rel:"noopener noreferrer"},ns=l(`<p>RRF 计算方法：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">score </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.0</span></span>
<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> q </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> queries:</span></span>
<span class="line"><span style="color:#24292E;">    score </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> ( k </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> rank(q,d) )</span></span>
<span class="line"><span style="color:#D73A49;">return</span><span style="color:#24292E;"> score</span></span>
<span class="line"><span style="color:#6A737D;"># 其中 d 为 文档，rank(q,d) 为不同 query 算法的排名</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hybird Search 评分计算流程图：</p><figure><img src="https://learn.microsoft.com/en-us/azure/search/media/hybrid-search/search-scoring-flow.png" alt="Hybird Search 评分计算流程图" tabindex="0" loading="lazy"><figcaption>Hybird Search 评分计算流程图</figcaption></figure><h3 id="_5-indexer-索引器" tabindex="-1"><a class="header-anchor" href="#_5-indexer-索引器" aria-hidden="true">#</a> 5. Indexer 索引器</h3>`,5),as={href:"https://learn.microsoft.com/en-us/azure/search/search-indexer-overview",target:"_blank",rel:"noopener noreferrer"},es={href:"https://learn.microsoft.com/en-us/azure/search/vector-search-integrated-vectorization",target:"_blank",rel:"noopener noreferrer"},ls={href:"https://learn.microsoft.com/en-us/azure/search/search-howto-indexing-azure-blob-storage",target:"_blank",rel:"noopener noreferrer"},os={href:"https://learn.microsoft.com/en-us/azure/search/search-howto-index-cosmosdb",target:"_blank",rel:"noopener noreferrer"},ps={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples/sample_indexers_operations.py",target:"_blank",rel:"noopener noreferrer"},rs={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples/sample_indexer_datasource_skillset.py",target:"_blank",rel:"noopener noreferrer"},cs=l(`<p>以下显示了如何使用索引器连接 Azure BLOB 存储的快速开始：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> SearchIndexerClient</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes.models </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    SearchIndexerDataContainer,</span></span>
<span class="line"><span style="color:#24292E;">    SearchIndexerDataSourceConnection,</span></span>
<span class="line"><span style="color:#24292E;">    SearchIndexer,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">connection_string_key </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;your blob storage account key&quot;</span></span>
<span class="line"><span style="color:#24292E;">connection_account_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;your blob storage account name&quot;</span></span>
<span class="line"><span style="color:#24292E;">connection_string </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;DefaultEndpointsProtocol=https;AccountName=</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">connection_account_name</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">;AccountKey=</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">connection_string_key</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">indexers_client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexerClient(service_endpoint, AzureKeyCredential(key))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># create a datasource</span></span>
<span class="line"><span style="color:#6A737D;"># IMPORTANT: Please make sure that you have create a container named \`container_name\`</span></span>
<span class="line"><span style="color:#24292E;">container_name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;searchcontainer&quot;</span></span>
<span class="line"><span style="color:#24292E;">container </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexerDataContainer(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">container_name)</span></span>
<span class="line"><span style="color:#24292E;">data_source_connection </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexerDataSourceConnection(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;indexer-datasource-sample&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;azureblob&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">connection_string</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">connection_string,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">container</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">container,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">data_source </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> indexers_client.create_data_source_connection(data_source_connection)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># create an indexer</span></span>
<span class="line"><span style="color:#24292E;">indexer </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexer(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sample-indexer&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">data_source_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;indexer-datasource-sample&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">target_index_name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">index_name,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> indexers_client.create_indexer(indexer)</span></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Create new Indexer - sample-indexer&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),ts={href:"https://learn.microsoft.com/zh-cn/azure/search/cognitive-search-concept-intro",target:"_blank",rel:"noopener noreferrer"},is=s("p",null,"AI 搜索内置了技能，并且我们也可以自定义技能。",-1),ds=s("h3",{id:"_6-analyzer-分析器",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_6-analyzer-分析器","aria-hidden":"true"},"#"),n(" 6. Analyzer 分析器")],-1),ys={href:"https://github.com/Azure/azure-sdk-for-python/blob/azure-search-documents_11.4.0/sdk/search/azure-search-documents/samples/sample_analyze_text.py",target:"_blank",rel:"noopener noreferrer"},us=s("code",null,"AnalyzeText",-1),vs=l(`<p>在 Azure AI 搜索中 <code>Analyzer = Tokenizer + TokenFilter + CharFilter</code>. AI 搜索的 analyzeText 具有内置的分析器。也可以自定义这些分析器。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Analyzer Can use for Debug for performance analysis</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> SearchIndexClient</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> azure.search.documents.indexes.models </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> AnalyzeTextOptions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SearchIndexClient(service_endpoint, AzureKeyCredential(key))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">analyze_request </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> AnalyzeTextOptions(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">text</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;One&#39;s &lt;two/&gt;&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">analyzer_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;standard.lucene&quot;</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.analyze_text(index_name, analyze_request)</span></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(result.as_dict())</span></span>
<span class="line"><span style="color:#032F62;">&quot;&quot;&quot; result.as_dict()</span></span>
<span class="line"><span style="color:#032F62;">{&#39;tokens&#39;: [{&#39;token&#39;: &quot;one&#39;s&quot;,</span></span>
<span class="line"><span style="color:#032F62;">&#39;start_offset&#39;: 0,</span></span>
<span class="line"><span style="color:#032F62;">&#39;end_offset&#39;: 5,</span></span>
<span class="line"><span style="color:#032F62;">&#39;position&#39;: 0},</span></span>
<span class="line"><span style="color:#032F62;">{&#39;token&#39;: &#39;two&#39;, &#39;start_offset&#39;: 7, &#39;end_offset&#39;: 10, &#39;position&#39;: 1}]}</span></span>
<span class="line"><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function ms(hs,Es){const a=p("ExternalLinkIcon");return r(),c("div",null,[i,d,s("p",null,[s("a",y,[n("产品文档参考"),e(a)])]),s("p",null,[s("a",u,[n("API 参考文档"),e(a)])]),s("p",null,[s("a",v,[n("示例"),e(a)])]),m,s("ul",null,[s("li",null,[h,n(": "),s("ul",null,[s("li",null,[s("a",E,[n("搜索"),e(a)]),n(" 索引文档，使用 "),s("a",b,[n("丰富的 queries"),e(a)]),n(" 和 "),s("a",_,[n("强大的数据整形"),e(a)])]),s("li",null,[s("a",f,[n("自动完成"),e(a)]),n(" 基于索引中文档的部分输入的搜索词")]),s("li",null,[s("a",A,[n("建议"),e(a)]),n(" 文档中最可能匹配的文本作为用户输入")]),s("li",null,[n("从索引中"),s("a",D,[n("添加、更新或删除文档"),e(a)])])])]),s("li",null,[g,n(" ("),s("a",q,[n("source code"),e(a)]),n("): "),s("ul",null,[s("li",null,[s("a",x,[n("创建、删除、更新或配置搜索索引 index"),e(a)])]),s("li",null,[s("a",C,[n("声明自定义同义词映射以扩展或重写查询 queries"),e(a)])]),F])]),s("li",null,[z,n(": "),s("ul",null,[s("li",null,[s("a",S,[n("启动索引器 indexer 自动爬取数据源"),e(a)])]),s("li",null,[s("a",k,[n("定义 AI 驱动的技能集以转换和丰富你的数据"),e(a)])])])])]),I,s("p",null,[n("要创建新的搜索服务，你可以使用 "),s("a",w,[n("Azure portal"),e(a)]),n(", "),s("a",T,[n("Azure PowerShell"),e(a)]),n(", 或 "),s("a",K,[n("Azure CLI"),e(a)]),n("..")]),P,s("p",null,[s("a",V,[n("参考 index CRUD 代码"),e(a)]),n(".")]),N,s("p",null,[s("a",R,[n("Azure sample"),e(a)]),n(".")]),H,s("ul",null,[s("li",null,[s("a",O,[n("hybird search"),e(a)])]),s("li",null,[s("a",L,[n("Full Text Search"),e(a)])]),s("li",null,[s("a",B,[n("Vector Search"),e(a)])])]),M,s("ol",null,[U,s("li",null,[n("使用倒排索引进行"),s("a",Q,[n("文档检索"),e(a)]),n("。")]),s("li",null,[n("使用句子 embedding 进行 "),s("a",W,[n("Scoring"),e(a)]),n(". 可以通过 "),Y,n(" 调整。")])]),J,X,$,s("ol",null,[j,G,s("li",null,[n("在查询响应中合并结果，使用 "),s("a",Z,[n("Reciprocal Rank Fusion (RRF)"),e(a)]),n(" 进行评分。（"),s("a",ss,[n("RRF 算法详细示例"),e(a)]),n("）")])]),ns,s("p",null,[n("你可以使用 "),s("a",as,[n("indexers"),e(a)]),n(" 自动化数据摄取，并使用 "),s("a",es,[n("integrated vectorization"),e(a)]),n(" 生成嵌入。Azure AI 搜索可以从两个数据源自动索引向量数据： "),s("a",ls,[n("Azure blob indexers"),e(a)]),n(" 和 "),s("a",os,[n("Azure Cosmos DB for NoSQL indexers"),e(a)]),n(".")]),s("p",null,[n("示例代码： "),s("a",ps,[n("indexer crud operations example"),e(a)]),n(" 和 "),s("a",rs,[n("indexer datasource skillset example"),e(a)]),n("。")]),cs,s("p",null,[n("Azure AI 搜索中的索引器是一个爬虫，它从云数据源提取文本数据并使用源数据与搜索索引之间的字段到字段映射填充搜索索引。索引器还驱动"),s("a",ts,[n("技能集执行和 AI 增强"),e(a)]),n("，你可以配置技能以在内容进入索引的途中集成额外的处理。")]),is,ds,s("p",null,[s("a",ys,[n("分析文本示例"),e(a)]),n("，更多详情，请参考"),us,n("源码。")]),vs])}const fs=o(t,[["render",ms],["__file","笔记ai_search_cn.html.vue"]]);export{fs as default};
