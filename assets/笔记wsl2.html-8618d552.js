import{_ as t,P as r,U as i,Y as a,a1 as e,X as s,aQ as o,E as d}from"./framework-6cee4965.js";const l={},c=o('<p>由于 Linux 桌面系统下有太多的不方便，如会议 app 功能不全、部分软件不支持（特别是 word、PPT 一系列的）。因此对于需要兼顾开发和办公的人员来说，使用 WSL2 或者虚拟机可能是一个比较权衡的选择。</p><p>目前 WSL2 可以和 VM 虚拟机共存了，个人推荐使用 WSL2，其支持 docker，个人在 Ubuntu 系统的 docker 与 WSL2 docker 中进行深度学习训练，WSL2 的性能丢失仅为 8%。此外他支持 U 盘接口等，文件储存方便，并且可以通过 WSL2 内的 Linux 子系统直接调用 windows 下的 <code>.exe</code> 文件。缺点就是 WSL2 默认是服务器终端，要设置桌面版教麻烦。</p><p>这边建议统一用 <strong>Windows Terminal</strong> 进行终端管理，进入微软商店直接搜索下载即可。</p><h2 id="wsl-下安装-ubuntu" tabindex="-1"><a class="header-anchor" href="#wsl-下安装-ubuntu" aria-hidden="true">#</a> WSL 下安装 ubuntu</h2><h3 id="wsl" tabindex="-1"><a class="header-anchor" href="#wsl" aria-hidden="true">#</a> WSL</h3>',5),p={href:"https://docs.microsoft.com/zh-cn/windows/wsl/install",target:"_blank",rel:"noopener noreferrer"},u=o(`<p><strong>可以通过微软商店安装，方便快捷</strong></p><p>也可以通过终端安装指定 WSL 版本，powershell 下执行 <code>wsl --install</code> 安装，之后可以安装对应的 Linux 版本：通过 <code>wsl --install -d &lt;Distribution Name&gt;</code> 安装。<code>wsl --list --online</code> 查看发行版本。</p><p>部分命令：</p><p>切换到子 Linux 系统中：<code>wsl -d Ubuntu-20.04 -u root</code> 查看全部安装的子系统：<code>wsl -l -v</code> 设置默认使用的系统：<code>wsl --setdefault &lt;DistributionName&gt;</code> 设置使用 WSL2：<code>wsl --set-version &lt;distro name&gt; 2</code></p><h3 id="更换-wsl-储存地址" tabindex="-1"><a class="header-anchor" href="#更换-wsl-储存地址" aria-hidden="true">#</a> 更换 WSL 储存地址</h3><p>子系统的备份与恢复：</p><p>WSL2 默认存放路径可以通过下面的，备份+恢复方式来修改。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--shutdown</span>
wsl <span class="token parameter variable">--export</span> Ubuntu-20.04 D:<span class="token punctuation">\\</span>Ubuntu-20.04.tar
<span class="token comment"># 卸载前必须备份，否则数据会全部丢失</span>
wsl <span class="token parameter variable">--unregister</span> Ubuntu-20.04
<span class="token comment"># 下面导入 WSL 系统， D:\\new_path\\就是储存文件的地方。</span>
wsl <span class="token parameter variable">--import</span> Ubuntu-20.04 D:<span class="token punctuation">\\</span>new_path<span class="token punctuation">\\</span> D:<span class="token punctuation">\\</span>Ubuntu-20.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此外 WSL 还支持预览功能（Linux GUI），但是需要加入 Windows 预览体验计划。</p><h3 id="其他-wsl-下的-ubuntu" tabindex="-1"><a class="header-anchor" href="#其他-wsl-下的-ubuntu" aria-hidden="true">#</a> 其他 WSL 下的 ubuntu</h3>`,10),h={href:"http://wujiawen.xyz/archives/linuxubuntu%E9%85%8D%E7%BD%AE%E4%B8%8E%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90",target:"_blank",rel:"noopener noreferrer"},m=a("h4",{id:"docker",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#docker","aria-hidden":"true"},"#"),e(" docker")],-1),w=a("li",null,[a("strong",null,"WSL2 下默认是不支持 systemctl 的"),e(" ，但可以手动使用 service 启动 docker 服务。")],-1),b={href:"https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/gpu-compute",target:"_blank",rel:"noopener noreferrer"},v=a("li",null,"你可能要重新配置以下 docker 以及 WSL2 的储存路径，否则 C 盘爆炸是一段时间内的事。",-1),k=o(`<h4 id="zsh" tabindex="-1"><a class="header-anchor" href="#zsh" aria-hidden="true">#</a> zsh</h4><ul><li>个人很喜欢使用 oh-my-zsh，包括其中的 autojump, autosuggestion 等插件等，能够极大的提高生产效率。 <strong>WSL2 设置 ZSH 为默认终端后，Windows Terminal 下的默认 Ubuntu 子系统快捷方式会消失，因此最保险的方式是安装非默认的 ubuntu 子系统，如 <code>Ubuntu-20.04</code> 等。</strong></li></ul><h3 id="wsl-下使用-windows-软件" tabindex="-1"><a class="header-anchor" href="#wsl-下使用-windows-软件" aria-hidden="true">#</a> WSL 下使用 windows 软件</h3><p>wsl 中可以使用 windows 上的软件，如 vscode, pycharm， typora 等。windows 下安装 vscode 后，在 wsl2 中可以使用 <code>code .</code> 自动打开工作目录，无需配置。</p><p>首先需要在 windows 中配置系统环境变量。而后在 wsl 的终端中设置环境变量，指向 windows 下软件的位置即可，如采用 zsh，则在 <code>.zshcr</code> 中配置:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>alias ty=&quot;/home/D/apps/Typora/Typora.exe&quot;  # 用 windows 上的 typora 打开 wsl2 中的文件。
alias nhere=&quot;explorer.exe&quot;                 # 在 windows 上打开 wsl 目录文件夹
alias pycharm=&quot;pycharm64.exe&quot;              # 用 windows 上的 pycharm 打开 wsl2 中的工作目录。
alias git=&quot;git.exe&quot;                        # 用 windows 上的 git，这是比较不推荐的。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),g={href:"https://www.jetbrains.com/help/pycharm/using-wsl-as-a-remote-interpreter-1.html",target:"_blank",rel:"noopener noreferrer"},_=o(`<h3 id="修改-wsl-的默认用户" tabindex="-1"><a class="header-anchor" href="#修改-wsl-的默认用户" aria-hidden="true">#</a> 修改 wsl 的默认用户</h3><p>通过 <code>wsl -l -v</code> 查看系统名称，如 <code>Ubuntu-18.04</code> 的话，命令行则使用 <code>ubuntu1804</code>。修改默认用户为 <code>kevin</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ubuntu2004 config --default-user kevin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改后，通过 vscode, pycharm, 文件管理器等 windows 应用访问时，默认采用 <code>kevin</code> 进行操作。若非必须的话，建议不用 <code>root</code> 作为默认用户，避免 linux 和 windows 系统文件权限不匹配的问题。</p><h4 id="目前发现问题" tabindex="-1"><a class="header-anchor" href="#目前发现问题" aria-hidden="true">#</a> 目前发现问题</h4><ul><li>由于 wsl 和 windows 共享磁盘，如 D，C 盘采用的磁盘格式特殊，因此无法修改共享磁盘下的文件权限。</li><li>如果使用 <code>apt-get install git</code> 再 linux 系统中安装 git 的话，默认情况下是不能够在挂载路径进行 git 操作的，如 <code>/mnt/d/xxx</code>。可以使用 <code>windows</code>下安装的 <code>git.exe</code>，设置 <code>alias git=git.exe</code>；但更推荐的是在非共享磁盘下进行进行 git 操作，然后采用上节介绍的方法来修改代码和文件，这样能省去很多 windows git 的麻烦。</li><li><code>No route to host</code> 错误：wlan 网络下应该禁用 internet 共享。确保 <code>控制面板\\网络和 Internet\\网络连接</code> 下的 WLAN-属性-共享下的与其他人共享 internet 功能没有开启</li></ul><h2 id="powershell" tabindex="-1"><a class="header-anchor" href="#powershell" aria-hidden="true">#</a> powershell</h2><p>推荐使用最新版的 powershell，从微软商店下载安装即可，这样可以省去很多 oh-my-posh 安装时候的坑。</p><h3 id="oh-my-posh" tabindex="-1"><a class="header-anchor" href="#oh-my-posh" aria-hidden="true">#</a> oh-my-posh</h3>`,9),x={href:"https://ohmyposh.dev/docs/installation/windows",target:"_blank",rel:"noopener noreferrer"},f={href:"https://sspai.com/post/69911",target:"_blank",rel:"noopener noreferrer"},y=a("h4",{id:"字体设计",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#字体设计","aria-hidden":"true"},"#"),e(" 字体设计")],-1),L={href:"https://www.nerdfonts.com/font-downloads",target:"_blank",rel:"noopener noreferrer"},S={href:"https://ohmyposh.dev/docs/configuration/fonts",target:"_blank",rel:"noopener noreferrer"},W=o(`<p>若使用 windows Terminal，则直接在设置里面配置使用字体即可。（windows terminal 》设置》配置文件》Powershell》外观》字体）个人采用了 <code>JetBrainsMono NF</code></p><h4 id="下载安装" tabindex="-1"><a class="header-anchor" href="#下载安装" aria-hidden="true">#</a> 下载安装</h4><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>winget install oh-my-posh  
<span class="token comment"># 很慢的话尝试下科学上网</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>完成后进行初始化，首先创建配置文件，<code>code $PROFILE</code>。往里面添加：<code>oh-my-posh init pwsh | Invoke-Expression</code>后保存。最后应用生效 <code>. $PROFILE</code></p><h4 id="主题设置" tabindex="-1"><a class="header-anchor" href="#主题设置" aria-hidden="true">#</a> 主题设置</h4><p>皮肤个人推荐 wopian，简约好看！</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code><span class="token comment"># code $PROFILE 而后在其中修改</span>
oh-my-posh init pwsh <span class="token operator">--</span>config ~\\AppData\\Local\\Programs\\oh-my-posh\\themes\\wopian<span class="token punctuation">.</span>omp<span class="token punctuation">.</span>json <span class="token punctuation">|</span> <span class="token function">Invoke-Expression</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，使用不同安装方式得到的主题路径不同，如下：</p><table><thead><tr><th><strong>安装方式</strong></th><th><strong>主题路径</strong></th></tr></thead><tbody><tr><td>Windows Scoop</td><td><code>~\\scoop\\apps\\oh-my-posh\\current\\themes\\wopian.omp.json</code></td></tr><tr><td>Windows Choco/Winget</td><td><code>~\\AppData\\Local\\Programs\\oh-my-posh\\themes\\wopian.omp.json</code></td></tr><tr><td>macOS Brew</td><td><code>~/.poshthemes/wopian.omp.json</code></td></tr><tr><td>GNU/Linux 命令行</td><td><code>~/.poshthemes/wopian.omp.json</code></td></tr><tr><td>自行下载</td><td>Oh my Posh 和 Themes 需要填完整的自定义路径</td></tr></tbody></table><h4 id="alias" tabindex="-1"><a class="header-anchor" href="#alias" aria-hidden="true">#</a> alias</h4><p><code>$PROFILE</code> 文件中添加：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Set-Alias <span class="token parameter variable">-Name</span> ty <span class="token parameter variable">-Value</span> D:<span class="token punctuation">\\</span>apps<span class="token punctuation">\\</span>Typora<span class="token punctuation">\\</span>Typora.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>对于有变量的命令，可以用函数进行间接设置：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token keyword">function</span> <span class="token function-name function">todo_func</span> <span class="token punctuation">{</span>D:<span class="token punctuation">\\</span>apps<span class="token punctuation">\\</span>Typora<span class="token punctuation">\\</span>Typora.exe D:<span class="token punctuation">\\</span>我的坚果云<span class="token punctuation">\\</span>todo<span class="token punctuation">\\</span>todo.md<span class="token punctuation">}</span>
Set-Alias <span class="token parameter variable">-Name</span> todo <span class="token parameter variable">-Value</span> todo_func
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自动跳转" tabindex="-1"><a class="header-anchor" href="#自动跳转" aria-hidden="true">#</a> 自动跳转</h4>`,15),D={href:"https://www.runoob.com/lua/lua-environment.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://github.com/skywind3000/z.lua.git",target:"_blank",rel:"noopener noreferrer"},P=a("code",null,"git clone https://github.com/skywind3000/z.lua.git",-1),U=o(`<p>最后在 powershell 的配置文件 <code>$PROFILE</code> 中引入插件即可：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Invoke-Expression <span class="token punctuation">(</span><span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>lua D:<span class="token punctuation">\\</span>apps<span class="token punctuation">\\</span>z.lua<span class="token punctuation">\\</span>z.lua <span class="token parameter variable">--init</span> powershell<span class="token punctuation">)</span> <span class="token parameter variable">-join</span> &quot;\`n&quot; <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>可能需要重启终端才能生效。另外 z.lua 采用了 <strong>子串匹配</strong> 的规则，而非最小编辑距离。因此如果要跳转到 <code>post</code> 文件夹的话，使用 <code>z pst</code> 是不行的。</p><h4 id="自动填充" tabindex="-1"><a class="header-anchor" href="#自动填充" aria-hidden="true">#</a> 自动填充</h4><p><code>https://github.com/PowerShell/PSReadLine</code> 中安装该插件</p><p>同样在 powershell 的 <code>$PROFILE</code> 中配置以下插件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Set-PSReadLineKeyHandler <span class="token parameter variable">-Key</span> <span class="token string">&quot;Ctrl+z&quot;</span> <span class="token parameter variable">-Function</span> Undo <span class="token comment"># 设置 Ctrl+z 为撤销</span>
Set-PSReadLineKeyHandler <span class="token parameter variable">-Key</span> UpArrow <span class="token parameter variable">-Function</span> HistorySearchBackward <span class="token comment"># 设置向上键为后向搜索历史记录</span>
Set-PSReadLineKeyHandler <span class="token parameter variable">-Key</span> DownArrow <span class="token parameter variable">-Function</span> HistorySearchForward <span class="token comment"># 设置向下键为前向搜索历史纪录</span>
Set-PSReadLineOption <span class="token parameter variable">-PredictionSource</span> History <span class="token comment"># 设置预测文本来源为历史记录</span>
Set-PSReadlineKeyHandler <span class="token parameter variable">-Key</span> Tab <span class="token parameter variable">-Function</span> Complete <span class="token comment"># 设置 Tab 键补全</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cmd" tabindex="-1"><a class="header-anchor" href="#cmd" aria-hidden="true">#</a> CMD</h2><p>CMD 个人使用的不多，放点链接直接跳过吧！</p>`,9),z={href:"https://chrisant996.github.io/clink/",target:"_blank",rel:"noopener noreferrer"};function N(F,I){const n=d("ExternalLinkIcon");return r(),i("div",null,[c,a("p",null,[e("安装 WSL 参考 "),a("a",p,[e("官方文档"),s(n)]),e("。必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。")]),u,a("p",null,[e("关于终端的配置可以参考我的另一篇博客 "),a("a",h,[e("Ubuntu 配置与软件推荐"),s(n)]),e("，此处列几个要点。")]),m,a("ul",null,[w,a("li",null,[e("对于深度学习 GPU 加速，可以参考"),a("a",b,[e("官方配置文档"),s(n)]),e(" ，个人推荐使用 nvidia-docker2。WSL2 中使用 CUDA 启动较慢，但是经过个人测试，深度学习训练效率相对于标准的 Ubuntu 下 nvidia-docker，仅降低了 7%左右。")]),v]),k,a("p",null,[e("此外 pycharm 等也可以配置 wsl 中的 python 解释器，参考："),a("a",g,[e("官方"),s(n)]),e(" 在添加解析器时候选择 wsl 就行。")]),_,a("p",null,[e("安装参考 "),a("a",x,[e("oh-my-posh 官网"),s(n)]),e("，网上也有很多博客如 "),a("a",f,[e("Oh My Posh：全平台终端提示符个性化工具"),s(n)])]),y,a("p",null,[e("从 "),a("a",L,[e("Nerd Font"),s(n)]),e(" 下载字体并安装（解压到 C:\\WINDOWS\\FONTS)，而后进行配置"),a("a",S,[e("参考官方"),s(n)]),e("。")]),W,a("p",null,[e("linux 下的 autojump 是真的好用，powershell 中的替代品为 z.lua。首先在 windows 中安装 "),a("a",D,[e("lua"),s(n)]),e(" 环境，安装后检查环境变量等是否正常。之后下载 "),a("a",E,[e("z.lua"),s(n)]),e(),P]),U,a("p",null,[e("插件："),a("a",z,[e("CLINK"),s(n)])])])}const q=t(l,[["render",N],["__file","笔记wsl2.html.vue"]]);export{q as default};
