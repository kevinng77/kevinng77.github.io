import{_ as t,E as p,S as o,W as l,$ as s,a3 as n,Z as i,aS as a}from"./framework-d5c0d2cb.js";const c={},u=a(`<p>RASA 感觉像是时代的眼泪了，自动 LLM 火了之后，类似 RASA 一类的传统 NLP 对话架构变得冷门，不少技术似乎也被摒弃。但如今不少厂家在实现对话机器人、智能服务等应用时，却也会用到这类型的框架。市面上提供类似 RASA 服务的 low code 平台也不少，如 Nuance, Omilia, Kore.ai 等。</p><p>该系列文章主要围绕 RASA 源码，整理落地部署 RASA 类似系统的一些笔记。</p><p>本文围绕 RASA 的源码架构，针对 RASA 自定义部署方式，RASA 代码拆解功能展开。</p><p>参考代码：</p><p>https://github.com/kevinng77/rasa_example/tree/master/examples/4_unpack_rasa</p><h3 id="安装环境" tabindex="-1"><a class="header-anchor" href="#安装环境" aria-hidden="true">#</a> 安装环境</h3><p>RASA 采用 poetry 进行包管理，可以直接 <code>poetry install</code> 来安装对应依赖。如果没有 poetry 的话，就：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>默认情况下官方推荐使用 <code>rasa run</code> 启动 nlu 以及 action 模块。</p><p>Entrypoint 对应的主函数在 <code>rasa/__main__.py</code> 中，因此我们以模块的方式运行它就行了。这也是 poetry 中触发 rasa 的方法。至于如何用 rasa 直接开启服务，可以查看 poetry python 包管理工具。</p><p>执行 <code>rasa train</code> 等价于 <code>python -m rasa train</code>；<code>rasa run actions</code> 相当于 <code>python -m rasa run actions</code>。</p><p>因此，如果我们只希望用到 rasa 当中的某个模块而非整个 rasa 模块，就可以避开其复杂的 sanic router，采用传统 python 的方式运行其中对应的函数了。</p><h2 id="自定义-channel" tabindex="-1"><a class="header-anchor" href="#自定义-channel" aria-hidden="true">#</a> 自定义 Channel</h2><p>https://github.com/kevinng77/rasa_example/tree/master/examples/5_custom_channel</p><p>自定义 channel 可以用于修改和用户交互的方式，或进行一些输出预处理等。比如开源的 RASA 并不支持语音功能，那么我们可以在自定义 Channel 当中加入 ASR 和 TTS 模块实现语音文字转换。</p><p>首先需要自定义 Input channel 模块，重写 <code>blueprint</code> 等模块，代码请参考</p><p>https://github.com/kevinng77/rasa_example/blob/master/examples/5_custom_channel/mychannel/myrest.py#L22</p>`,17),r=s("code",null,"sent_text_message",-1),d=s("code",null,"sent_image_url",-1),k={href:"https://github.com/kevinng77/rasa_example/blob/master/examples/5_custom_channel/mychannel/myrest.py#L196",target:"_blank",rel:"noopener noreferrer"},v=a(`<p>https://github.com/kevinng77/rasa_example/blob/master/examples/5_custom_channel/mychannel/myrest.py#L196</p><p>最后在 <code>credentials.yml</code> 中配置使用我们定义的 Channel：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">mychannel.myrest.RestInput</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>配置完成后启动整个 rasa 服务：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>rasa train
rasa run actions <span class="token operator">&amp;</span>
rasa run <span class="token operator">-</span><span class="token operator">-</span>enable<span class="token operator">-</span>api
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>打开一个新的终端 B 输入：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -X POST http://localhost:5005/webhooks/rest/mywebhook \\
-H &quot;Content-Type: application/json&quot; \\
-d &#39;{  &quot;sender&quot;: &quot;change_to_your_name&quot;,   &quot;message&quot;: &quot;Find me some good venues&quot;}&#39; 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你会在终端 A 中看到：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>This is a custom webhook made by me.
&gt;&gt;&gt; you could see the following information: sender_id change_to_your_name,
 text Find me some good venues
&gt;&gt;&gt; the custom channel is used for custom front-end interaction, if you want to save
middleware information, please use custom trackerstore, see next example
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们主要将 channel 自定义在了 <code>mychannel</code> 中，并在 <code>RestInput.blueprint()</code> 中修改了 app 的 router。</p><h3 id="webui" tabindex="-1"><a class="header-anchor" href="#webui" aria-hidden="true">#</a> WebUI</h3><p>对于使用 RASA 搭建 WebUI，可以考虑使用 widget + socket IO 的方式实现。</p><p>https://github.com/kevinng77/rasa_example/tree/master/examples/8_wedget</p><ol><li>在 credentials 中添加设置 socketio 通道:</li></ol><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">socketio</span><span class="token punctuation">:</span>
  <span class="token key atrule">user_message_evt</span><span class="token punctuation">:</span> user_uttered
  <span class="token key atrule">bot_message_evt</span><span class="token punctuation">:</span> bot_uttered
  <span class="token key atrule">session_persistence</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>启动 RASA 服务</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rasa train
rasa run actions <span class="token operator">&amp;</span>
rasa run --enable-api <span class="token parameter variable">--cors</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>在任意 HTML 文件中添加（记得修改你的 websocket 为 <code>http://&lt;ip&gt;:&lt;port&gt;/socket.io</code>）:</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rasa-chat-widget<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-websocket-url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://40.76.242.139:5005/socket.io<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/@rasahq/rasa-chat<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>而后打开该网页，就能看到 UI 右下角的对话框了。</p><h2 id="配置-redis-储存" tabindex="-1"><a class="header-anchor" href="#配置-redis-储存" aria-hidden="true">#</a> 配置 Redis 储存</h2><p>使用 redis tracker store 记录 session 还有 tracker。</p><p>https://github.com/kevinng77/rasa_example/tree/master/examples/6_redis_store</p><p>配置 redis 需要同时开启 rasa 和 redis 服务，为了方便 debug 及查看 redis 中的数据，我们同时部署 redis 和 redisinsight，编写以下 docker compose 文件：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.0&quot;</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 127.0.0.1<span class="token punctuation">:</span>6379<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> $PWD/redis_data<span class="token punctuation">:</span>/data
      <span class="token punctuation">-</span> $PWD/myredis.conf<span class="token punctuation">:</span>/etc/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span>
      redis<span class="token punctuation">-</span>server <span class="token punctuation">-</span><span class="token punctuation">-</span>save 60 1 <span class="token punctuation">-</span><span class="token punctuation">-</span>requirepass 777777

  <span class="token key atrule">redisinsight</span><span class="token punctuation">:</span>  
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redislabs/redisinsight
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redisinsight
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">&quot;host&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而后启动服务 <code>docker compose up -d</code></p><p>我们在 <code>endpoints.yml</code> 中配置好应用 redis 的一些参数:</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">rest</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>而后启动服务：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rasa run actions <span class="token operator">&amp;</span>
rasa run --enable-api
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>打开新终端尝试发送一个 POST 到服务器：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST http://localhost:5005/webhooks/rest/webhook <span class="token punctuation">\\</span>
<span class="token parameter variable">-H</span> <span class="token string">&quot;Content-Type: application/json&quot;</span> <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token string">&#39;{  &quot;sender&quot;: &quot;change_to&quot;,   &quot;message&quot;: &quot;Find me some good venues&quot;}&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行发送后，rasa 在处理上面这个请求时，会将 tracker 记录在 redis 中。我们打开 <code>your_ip:8001</code> 查看，如下填写，其中密码是 777777：</p><figure><img src="https://pic2.zhimg.com/80/v2-072028dcd5bbc1a80429c67e9f71684d_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>在 browser 中我们可以查看到 redis 数据库中的记录：</p><figure><img src="https://pic4.zhimg.com/80/v2-a1363bfce70bbbfd31cb7393b7a68fa3_1440w.webp" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>完整的 session 数据：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;events&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
	<span class="token comment">// 此处省略一些 session 内容</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.4886646</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Find me some good venues&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;parse_data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;intent&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;search_venues&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;confidence&quot;</span><span class="token operator">:</span> <span class="token number">0.9929251670837402</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;entities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Find me some good venues&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;message_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e75148a4a0ad4f8cb1168d716ea43479&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;text_tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;intent_ranking&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;greet&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;confidence&quot;</span><span class="token operator">:</span> <span class="token number">0.00012646465620491654</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;thankyou&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;confidence&quot;</span><span class="token operator">:</span> <span class="token number">1.6760051948949695e-05</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;input_channel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rest&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e75148a4a0ad4f8cb1168d716ea43479&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user_featurization&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.5121474</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;use_text_for_featurization&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.5121644</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action_search_venues&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;policy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemoizationPolicy&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;confidence&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;action_text&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
      <span class="token property">&quot;hide_rule_turn&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bot&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.5122068</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;here are some venues I found&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;elements&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;quick_replies&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;buttons&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;attachment&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;custom&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;slot&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.5122104</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;venues&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Big Arena&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;reviews&quot;</span><span class="token operator">:</span> <span class="token number">4.5</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rock Cellar&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;reviews&quot;</span><span class="token operator">:</span> <span class="token number">5.0</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1679306228.516813</span><span class="token punctuation">,</span>
      <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;model_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1105180adce4701ac369a4b0ef90c8b&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action_listen&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;policy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemoizationPolicy&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;confidence&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;action_text&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
      <span class="token property">&quot;hide_rule_turn&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;change_to&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中比较重要的包括：<code>intent_ranking</code> ，entity 等数据都有。</p><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结" aria-hidden="true">#</a> 小结</h2><ol><li><p>RASA 采用 sanic 搭建 API 服务，NLU 和 Dialog 模块分别由两个 API 服务组成（Kore.ai, Nuance 等平台也是采用该方案）。</p></li><li><p>RASA 中对轮对话方案是通过将用户历史的 intent, message, slot 等储存在服务器中实现的。（用户只想后端发送 message 和 session_id）。可以参考目前大多数 GPT 客户端多轮对话的方案，将历史对话信息储存在用户客户端的 Session Storage 或者 Local Storage 中，来环节本地储存的压力。</p></li><li><p>RASA 免费版支持的 Channel 较少，我们可以自定义 Channel 实现语音对话等功能。对于 Web UI 搭建的话，RASA 提供的 Widget 还是挺不错的。</p></li></ol>`,41);function m(b,q){const e=p("ExternalLinkIcon");return o(),l("div",null,[u,s("p",null,[n("而后根据需求对 Output Channel 的 "),r,n(", "),d,n("也进行重写，"),s("a",k,[n("示例代码"),i(e)]),n("。")]),v])}const y=t(c,[["render",m],["__file","笔记rasa2.html.vue"]]);export{y as default};
