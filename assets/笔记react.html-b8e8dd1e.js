import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as p,c as r,e as c,a as s,b as n,d as a,f as l}from"./app-61501907.js";const i={},d=s("p",null,[n("在最新的前端开发技术中，React 是一个非常流行且被广泛采用的 "),s("strong",null,"JavaScript 库"),n(" 之一。React 以声明式的方式处理用户界面，使开发者能够使用组件来构建可重用和可维护的界面。这篇文章将会带你从基础入门开始，愉快的学习 React！")],-1),u=s("p",null,"参考 https://react.dev/learn",-1),y=l(`<p>编辑器：VS Code（装插件：ESLint、Prettier、React Developer Tools 浏览器扩展）</p><hr><h2 id="_1-项目结构速览-脚手架生成" tabindex="-1"><a class="header-anchor" href="#_1-项目结构速览-脚手架生成" aria-hidden="true">#</a> 1. 项目结构速览（脚手架生成）</h2><p>许多工具都能够创建一个 react 模板项目，如 React Router (v7)。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">npx</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create-react-router@latest</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>脚手架会生成一个以 <strong>数据路由（Data Routers）</strong> 为中心的结构，大致包含：</p><table><thead><tr><th>文件夹/文件</th><th>说明</th></tr></thead><tbody><tr><td><code>app/</code></td><td>主要代码目录（类似 Remix）</td></tr><tr><td>┣ <code>routes/</code></td><td>路由文件夹（文件即路由）</td></tr><tr><td>┃ ┣ <code>home.tsx</code></td><td><code>/home</code> 页面组件</td></tr><tr><td>┃ ┗ <code>routes.ts</code></td><td>导出路由定义（自动生成用）</td></tr><tr><td>┣ <code>welcome/</code></td><td>可选嵌套路由或组件目录</td></tr><tr><td>┣ <code>root.tsx</code></td><td>根路由，包含全局布局、导航、错误边界等</td></tr><tr><td>┗ <code>app.css</code></td><td>全局样式</td></tr><tr><td><code>react-router.config.ts</code></td><td>React Router 配置文件（例如 SSR 设置）</td></tr><tr><td><code>vite.config.ts</code></td><td>Vite 构建配置</td></tr><tr><td><code>tsconfig.json</code></td><td>TypeScript 配置</td></tr><tr><td><code>Dockerfile</code></td><td>容器部署配置（可忽略）</td></tr></tbody></table>`,7),v=s("strong",null,"组件路由依然可用，但推荐路由模块（文件即路由）+ 数据 API（loader/action）",-1),h={href:"https://reactrouter.com/?utm_source=chatgpt.com",target:"_blank",rel:"noopener noreferrer"},m=l(`<hr><h2 id="_2-启动项目" tabindex="-1"><a class="header-anchor" href="#_2-启动项目" aria-hidden="true">#</a> 2. 启动项目</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># 进入项目</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">my-react-router-app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="color:#6F42C1;">npm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 启动开发服务器</span></span>
<span class="line"><span style="color:#6F42C1;">npm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>默认情况下启动在 5173 端口</p><hr><h2 id="_3-react-基础-组件-jsx-状态" tabindex="-1"><a class="header-anchor" href="#_3-react-基础-组件-jsx-状态" aria-hidden="true">#</a> 3. React 基础：组件 + JSX + 状态</h2><p>我们先从最核心的 React 概念讲起：</p><ol><li>什么是组件？</li></ol><div class="language-tsx line-numbers-mode" data-ext="tsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Profile</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">img</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;https://i.imgur.com/MK3eW3Am.jpg&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">alt</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Katherine Johnson&quot;</span></span>
<span class="line"><span style="color:#24292E;">    /&gt;</span></span>
<span class="line"><span style="color:#24292E;">  )</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中：</p><ul><li><code>Profile</code> 是组件名。</li><li>它返回一个 <code>&lt;img /&gt;</code> 标签。</li><li>通过 <code>export default</code> 导出，便于在其他文件中 <code>import Profile from &#39;./Profile&#39;</code> 使用。</li></ul><hr><ol start="2"><li>如何使用组件？</li></ol><p>你定义好了组件，就可以在其他组件中像使用 HTML 标签那样使用它：</p><div class="language-tsx line-numbers-mode" data-ext="tsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Profile</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">img</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;https://i.imgur.com/MK3eW3Am.jpg&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">alt</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Katherine Johnson&quot;</span></span>
<span class="line"><span style="color:#24292E;">    /&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Gallery</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">section</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;Amazing scientists&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#005CC5;">Profile</span><span style="color:#24292E;"> /&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#005CC5;">Profile</span><span style="color:#24292E;"> /&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#005CC5;">Profile</span><span style="color:#24292E;"> /&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">section</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：</p><ul><li><p><code>&lt;section&gt;</code> 是 HTML 原生标签，因为首字母是小写。</p></li><li><p><code>&lt;Profile /&gt;</code> 是我们定义的组件，因为首字母大写。</p></li><li><p>组件可以被重复使用、嵌套组合，从而构建复杂界面。</p></li><li><p>组件传递参数方式：</p></li></ul><p>示例（简化版）：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 父组件</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">Avatar</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">person</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{{ name: </span><span style="color:#032F62;">&#39;Lin Lanying&#39;</span><span style="color:#24292E;">, imageId: </span><span style="color:#032F62;">&#39;1bX5QH6&#39;</span><span style="color:#24292E;"> }} </span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">size</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">} </span></span>
<span class="line"><span style="color:#24292E;">/&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19),b=s("code",null,"Avatar",-1),E=s("code",null,"person",-1),f=s("code",null,"size",-1),g={href:"https://react.dev/learn/passing-props-to-a-component",target:"_blank",rel:"noopener noreferrer"},_=l(`<ul><li>读取 props</li></ul><p>在子组件中，你可以通过函数参数接收到 props 对象，例如：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Avatar</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">person</span><span style="color:#24292E;">, </span><span style="color:#E36209;">size</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 此处 person 和 size 可用</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">img</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">getImageUrl</span><span style="color:#24292E;">(person)}</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">alt</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{person.name}</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">width</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{size}</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">height</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{size}</span></span>
<span class="line"><span style="color:#24292E;">    /&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>说明：</p>`,4),A=s("code",null,"function Avatar(props)",-1),C=s("code",null,"function Avatar({ person, size })",-1),x=s("strong",null,"解构赋值",-1),D={href:"https://react.dev/learn/passing-props-to-a-component",target:"_blank",rel:"noopener noreferrer"},k=s("li",null,"在子组件内部，就像使用局部变量一样使用这些 props。",-1),F=l(`<p>React 组件可以接收 <code>children</code> prop，表示标签里嵌套的内容（children 是一个 component）：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Card</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">children</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">className</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;card&quot;</span><span style="color:#24292E;">&gt;{children}&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">Card</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">Avatar</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">size</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">} </span><span style="color:#6F42C1;">person</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{…} /&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#005CC5;">Card</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),R=s("code",null,"<Avatar …/>",-1),I=s("code",null,"Card",-1),j=s("code",null,"children",-1),q=s("code",null,"Card",-1),S={href:"https://react.dev/learn/passing-props-to-a-component",target:"_blank",rel:"noopener noreferrer"},w=l(`<hr><p>默认导出（default export） vs 命名导出（named export）</p><p>::: important</p><p>引用和定义组件请使用大写开头。</p><p>注意：一个文件最多只能有一个默认导出，但可以有多个命名导出。</p><p>不要在一个 component 里面定义另一个 component。</p><table><thead><tr><th>Syntax</th><th>Export statement</th><th>Import statement</th></tr></thead><tbody><tr><td>Default</td><td><code>export default function Button() {}</code></td><td><code>import Button from &#39;./Button.js&#39;;</code></td></tr><tr><td>Named</td><td><code>export function Button() {}</code></td><td><code>import { Button } from &#39;./Button.js&#39;;</code></td></tr></tbody></table><p>:::</p><hr><ol start="3"><li>JSX</li></ol><p>JSX 是 JavaScript 的一个语法扩展，允许你在 JS 文件里写看起来像 HTML 的标记（markup）来描述 UI。虽然不是必须，但大多数 React 开发者更喜欢使用 JSX，因为它让 “渲染逻辑” 与 “标记内容” 紧密结合。</p><p>在传统 Web 开发中：内容 (HTML)、样式 (CSS)、逻辑 (JavaScript) 往往分离；但随着交互变多，逻辑主导内容越来越常见。JSX 支持将逻辑 + 标记放在一起。</p><p><strong>示例：</strong> 一个常见的 HTML 片段：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">&lt;h1&gt;Hedy Lamarr&#39;s Todos&lt;/h1&gt;</span></span>
<span class="line"><span style="color:#24292e;">![相关图片](https://i.imgur.com/yXOvdOSs.jpg )</span></span>
<span class="line"><span style="color:#24292e;">&lt;ul&gt;</span></span>
<span class="line"><span style="color:#24292e;">  &lt;li&gt;Invent new traffic lights&lt;/li&gt;</span></span>
<span class="line"><span style="color:#24292e;">  &lt;li&gt;Rehearse a movie scene&lt;/li&gt;</span></span>
<span class="line"><span style="color:#24292e;">  &lt;li&gt;Improve the spectrum technology&lt;/li&gt;</span></span>
<span class="line"><span style="color:#24292e;">&lt;/ul&gt;</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14),P={href:"https://react.dev/learn/writing-markup-with-jsx",target:"_blank",rel:"noopener noreferrer"},N=l(`<p>主要差别包括：</p><ul><li>必须有一个单一根元素（或使用 Fragment）</li><li>所有标签必须闭合，包括自闭合标签（如 <code>&lt;img /&gt;</code>）</li><li>属性名大多使用 camelCase（而不是 HTML 的 kebab-case 或 “class”）</li><li>某些 HTML 属性名在 JSX 中被替换，比如 <code>class</code> → <code>className</code>，<code>stroke-width</code> → <code>strokeWidth</code> 等。</li></ul><p>以下为正确 jsx 示例</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TodoList</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;Hedy Lamarr&#39;s Todos&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">img</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;https://i.imgur.com/yXOvdOSs.jpg&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">alt</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Hedy Lamarr&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">className</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;photo&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">      /&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">ul</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;Invent new traffic lights&lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;Rehearse a movie scene&lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;Improve the spectrum technology&lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;/</span><span style="color:#22863A;">ul</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>JSX 中的条件渲染</p>`,6),L={href:"https://react.dev/learn/conditional-rendering",target:"_blank",rel:"noopener noreferrer"},M=s("code",null,"{ cond ? <A /> : <B /> }",-1),H={href:"https://react.dev/learn/conditional-rendering",target:"_blank",rel:"noopener noreferrer"},J=s("code",null,"{ cond && <A /> }",-1),z={href:"https://react.dev/learn/conditional-rendering",target:"_blank",rel:"noopener noreferrer"},X={href:"https://react.dev/learn/conditional-rendering",target:"_blank",rel:"noopener noreferrer"},T=l(`<div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Item</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">name</span><span style="color:#24292E;">, </span><span style="color:#E36209;">isPacked</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (isPacked) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">className</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;{name} ✅&lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 什么都不想渲染，可以 return null</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">className</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">&gt;{name}&lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>JSX 中渲染列表</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">people</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">  { id: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, name: </span><span style="color:#032F62;">&#39;Creola Katherine Johnson&#39;</span><span style="color:#24292E;">, profession: </span><span style="color:#032F62;">&#39;mathematician&#39;</span><span style="color:#24292E;">, … },</span></span>
<span class="line"><span style="color:#24292E;">  { id: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, name: </span><span style="color:#032F62;">&#39;Mario José Molina-Pasquel Henríquez&#39;</span><span style="color:#24292E;">, profession: </span><span style="color:#032F62;">&#39;chemist&#39;</span><span style="color:#24292E;">, … },</span></span>
<span class="line"><span style="color:#24292E;">  …</span></span>
<span class="line"><span style="color:#24292E;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">chemists</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> people.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">person</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">  person.profession </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;chemist&#39;</span></span>
<span class="line"><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">listItems</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> chemists.</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#E36209;">person</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">li</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">key</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{person.id}&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">img</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">getImageUrl</span><span style="color:#24292E;">(person)} </span><span style="color:#6F42C1;">alt</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{person.name} /&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">b</span><span style="color:#24292E;">&gt;{person.name}:&lt;/</span><span style="color:#22863A;">b</span><span style="color:#24292E;">&gt; {person.profession} known for {person.accomplishment}</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">li</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">ul</span><span style="color:#24292E;">&gt;{listItems}&lt;/</span><span style="color:#22863A;">ul</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),V={href:"https://react.dev/learn/rendering-lists",target:"_blank",rel:"noopener noreferrer"},B=s("code",null,"map()",-1),O={href:"https://react.dev/learn/rendering-lists",target:"_blank",rel:"noopener noreferrer"},U=s("code",null,"filter()",-1),W={href:"https://react.dev/learn/rendering-lists",target:"_blank",rel:"noopener noreferrer"},K=s("code",null,"key",-1),G={href:"https://react.dev/learn/rendering-lists",target:"_blank",rel:"noopener noreferrer"},Q=s("hr",null,null,-1),Y=s("h2",{id:"_4-事件处理",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-事件处理","aria-hidden":"true"},"#"),n(" 4. 事件处理")],-1),$=s("p",null,"React 允许你在 JSX 中给元素添加事件处理器（event handlers），用来响应点击 (click)、悬浮 (hover)、输入焦点 (focus)、表单提交 (submit) 等用户交互。",-1),Z=s("code",null,"onClick={…}",-1),ss={href:"https://react.dev/learn/responding-to-events",target:"_blank",rel:"noopener noreferrer"},ns=s("p",null,"常见步骤：",-1),es=s("li",null,[n("在组件内部声明一个函数（如 "),s("code",null,"handleClick"),n("）")],-1),as=s("li",null,[n("在函数体内实现逻辑（例如 "),s("code",null,"alert('You clicked me!')"),n("）")],-1),ls=s("code",null,"<button onClick={handleClick}>…</button>",-1),os={href:"https://react.dev/learn/responding-to-events",target:"_blank",rel:"noopener noreferrer"},ts={href:"https://react.dev/learn/responding-to-events",target:"_blank",rel:"noopener noreferrer"},ps=l(`<p><strong>重要坑</strong> ：必须 <em>传递</em> 函数，而不是 <em>调用</em> 函数。当你写 <code>onClick={handleClick()}</code> 则会在渲染时立即执行，而不是在点击时执行。</p><h3 id="将事件处理器作为-props-传递-passing-event-handlers-as-props" tabindex="-1"><a class="header-anchor" href="#将事件处理器作为-props-传递-passing-event-handlers-as-props" aria-hidden="true">#</a> 将事件处理器作为 Props 传递（Passing event handlers as props）</h3><p><strong>要点</strong> ：</p><ul><li><p>如果你有一个通用组件（例如 <code>Button</code>），它并不知道每次点击应该做什么。你可以把行为（函数）作为 prop 传给它：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Button</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">onClick</span><span style="color:#24292E;">, </span><span style="color:#E36209;">children</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onClick</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{onClick}&gt;{children}&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>父组件决定要做的事情，比如：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PlayButton</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">movieName</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handlePlayClick</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">alert</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`Playing \${</span><span style="color:#24292E;">movieName</span><span style="color:#032F62;">}!\`</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#005CC5;">Button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onClick</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{handlePlayClick}&gt;Play &quot;{movieName}&quot;&lt;/</span><span style="color:#005CC5;">Button</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>关于事件 handler prop 命名的约定：对于自定义组件，通常将 prop 名以 <code>on…</code> 开头，如 <code>onClick</code>、<code>onSmash</code> 等。这样代码易读、意义明确。</p></li></ul><hr><h2 id="_5-状态" tabindex="-1"><a class="header-anchor" href="#_5-状态" aria-hidden="true">#</a> 5. 状态</h2><p>在 React 中，用 Hook <code>useState</code> 来创建状态变量。文档示例：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useState } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;react&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">index</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setIndex</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意 Hooks 的使用规则：</p>`,9),rs={href:"https://react.dev/learn/state-a-components-memory",target:"_blank",rel:"noopener noreferrer"},cs=s("li",null,[n("这保证每次渲染时 "),s("code",null,"useState"),n(" 被调用的次数与顺序不变，这是 React 区分不同状态变量的关键。")],-1),is=l(`<p>状态的「私有性」与“隔离”</p><ul><li>状态是 <strong>组件实例</strong> 专属的。若你在 UI 上渲染同一个组件两次， <strong>每一个实例</strong> 都会有自己的状态拷贝，互不影响。</li><li>父组件无法直接 “操控” 子组件内部声明的状态（除非你通过 props 或回调把状态提升上来）。状态默认只是组件自己的“私有记忆”。</li></ul><hr><p>在一次渲染周期（render）中，state 的值 <strong>对该渲染函数及其事件处理器而言是固定的</strong> 。如果在同一个渲染中多次 <code>setState(state + 1)</code>，那么每次 <code>state</code> 的 “快照值” 均不会更新，因此可能不会按你预期累加多次。示例：点击 “+3” 按钮只加 1。</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useState } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;react&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Counter</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">number</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setNumber</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;{number}&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onClick</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(number </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(number </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(number </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      }}&gt;+3&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/&gt;</span></span>
<span class="line"><span style="color:#24292E;">  )</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在写 <code>useState</code> + 事件处理的时候， <strong>假设 state 在当前渲染中是固定不变的</strong> 。</p><p>避免在一系列 <code>setState(state + 1)</code> 中预期“连续更新”而不使用函数式更新。</p><p>如果你的处理逻辑需要 “最新” state 值（如 +3、+5、基于当前值累加等），建议改写为：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(</span><span style="color:#E36209;">prev</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> prev </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(</span><span style="color:#E36209;">prev</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> prev </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6F42C1;">setNumber</span><span style="color:#24292E;">(</span><span style="color:#E36209;">prev</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> prev </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者直接：<code>setNumber(prev =&gt; prev + 3);</code></p><hr><p><strong>文中强调：你应当把 state 中的对象当作“只读”的（read-only）。不要直接修改。</strong></p><p>但如果你想要修改 state 中的对象，举例：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">position</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setPosition</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">({ x:</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, y:</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#24292E;">position.x </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> e.clientX;  </span><span style="color:#6A737D;">// 直接修改对象 —— 问题在这里</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这种做法会导致 React <strong>无法检测到变化</strong> ，所以组件不会重新渲染。</p><p>如果你的 state 存的是一个对象，而你只想更新对象中的一个字段，可以使用对象的拷贝语法（spread）来创建新的对象。</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">setPerson</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">person,           </span><span style="color:#6A737D;">// 复制以前的所有字段</span></span>
<span class="line"><span style="color:#24292E;">  firstName: e.target.value  </span><span style="color:#6A737D;">// 覆盖某个字段</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样可以避免手动写出所有字段，比较方便。</p><hr><ul><li>状态中的 Array</li></ul><p>React 的状态更新机制依赖 <strong>引用变化</strong> 来决定是否需要重新渲染。若直接改变已有数组（如 <code>arr.push()</code> 或 <code>arr[0] = …</code>），原数组引用不变，可能导致 React <strong>无法识别变化</strong> ，或者造成难以发现的副作用。</p><h3 id="_1-添加元素-add" tabindex="-1"><a class="header-anchor" href="#_1-添加元素-add" aria-hidden="true">#</a> 1. 添加元素（Add）</h3>`,22),ds=s("strong",null,"不推荐：",-1),us=s("code",null,"push()",-1),ys={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},vs=s("strong",null,"推荐：",-1),hs=s("code",null,"concat()",-1),ms=l(`<div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// TypeScript + React</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">items</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setItems</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">MyItemType</span><span style="color:#24292E;">[]&gt;([]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在末尾添加：</span></span>
<span class="line"><span style="color:#6F42C1;">setItems</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">items,</span></span>
<span class="line"><span style="color:#24292E;">  newItem</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在开头添加：</span></span>
<span class="line"><span style="color:#6F42C1;">setItems</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">  newItem,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">items</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),bs={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},Es=l(`<hr><h3 id="_2-删除元素-remove" tabindex="-1"><a class="header-anchor" href="#_2-删除元素-remove" aria-hidden="true">#</a> 2. 删除元素（Remove）</h3><p>推荐使用 <code>filter()</code> 方法：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">setItems</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  items.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">item</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> item.id </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> targetId)</span></span>
<span class="line"><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),fs=s("strong",null,"新数组",-1),gs={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},_s=l(`<hr><h3 id="_3-转换-更新元素-transform-replace" tabindex="-1"><a class="header-anchor" href="#_3-转换-更新元素-transform-replace" aria-hidden="true">#</a> 3. 转换/更新元素（Transform / Replace）</h3><p>当你想更新数组中某些元素（例如改变某项属性）：</p><p>推荐使用 <code>map()</code>：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">setItems</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  items.</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#E36209;">item</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    item.id </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> targetId </span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> { </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">item, someProp: newValue }  </span><span style="color:#6A737D;">// 创建新对象</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> item  </span><span style="color:#6A737D;">// 保持原对象</span></span>
<span class="line"><span style="color:#24292E;">  )</span></span>
<span class="line"><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),As={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},Cs=l(`<hr><h3 id="_4-插入元素到中间位置-insert" tabindex="-1"><a class="header-anchor" href="#_4-插入元素到中间位置-insert" aria-hidden="true">#</a> 4. 插入元素到中间位置（Insert）</h3><p>如果要在数组中间某个位置插入一个新项：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">index</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">setItems</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">items.</span><span style="color:#6F42C1;">slice</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, index),</span></span>
<span class="line"><span style="color:#24292E;">  newItem,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">items.</span><span style="color:#6F42C1;">slice</span><span style="color:#24292E;">(index)</span></span>
<span class="line"><span style="color:#24292E;">]);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),xs=s("code",null,"slice()",-1),Ds={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},ks=s("hr",null,null,-1),Fs=s("h3",{id:"_5-其他需要注意的变动-排序、反转、深层嵌套修改",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_5-其他需要注意的变动-排序、反转、深层嵌套修改","aria-hidden":"true"},"#"),n(" 5. 其他需要注意的变动（排序、反转、深层嵌套修改）")],-1),Rs=s("code",null,"sort()",-1),Is=s("code",null,"reverse()",-1),js=s("strong",null,"原地修改数组",-1),qs=s("code",null,"const newArr = [...oldArr]",-1),Ss=s("code",null,"newArr.sort()",-1),ws=s("code",null,"newArr.reverse()",-1),Ps=s("code",null,"setItems(newArr)",-1),Ns={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},Ls=s("code",null,"[...oldArr]",-1),Ms={href:"https://react.dev/learn/updating-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},Hs=s("hr",null,null,-1),Js=s("h2",{id:"_6-reducer",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_6-reducer","aria-hidden":"true"},"#"),n(" 6. Reducer")],-1),zs=s("p",null,[n("当有一个组件的状态逻辑非常复杂（比如需要进行添加，删除，修改等操作），可以考虑使用 reducer，而不是 state。在 Redux、MobX 等状态管理库流行之前，这种模式就已被广泛采用。React 自身也鼓励在适合场景下使用 "),s("code",null,"useReducer"),n("。")],-1),Xs=s("h3",{id:"编写-reducer-函数",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#编写-reducer-函数","aria-hidden":"true"},"#"),n(" 编写 reducer 函数")],-1),Ts=s("code",null,"reducer",-1),Vs=s("code",null,"(state, action) => nextState",-1),Bs={href:"https://react.dev/learn/extracting-state-logic-into-a-reducer",target:"_blank",rel:"noopener noreferrer"},Os=l(`<p>在例子中，<code>tasksReducer(tasks, action)</code> 根据 <code>action.type</code> 返回新的数组状态：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tasksReducer</span><span style="color:#24292E;">(</span><span style="color:#E36209;">tasks</span><span style="color:#24292E;">, </span><span style="color:#E36209;">action</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">switch</span><span style="color:#24292E;">(action.type) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;added&#39;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">...</span><span style="color:#24292E;">tasks, { id: action.id, text: action.text, done: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> }];</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;changed&#39;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> tasks.</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#E36209;">t</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> t.id </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> action.task.id </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> action.task </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> t);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;deleted&#39;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> tasks.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">t</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> t.id </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> action.id);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">default</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;Unknown action: &#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> action.type);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Us={href:"https://react.dev/learn/extracting-state-logic-into-a-reducer",target:"_blank",rel:"noopener noreferrer"},Ws={href:"https://react.dev/learn/extracting-state-logic-into-a-reducer",target:"_blank",rel:"noopener noreferrer"},Ks=s("h3",{id:"在组件中使用-usereducer",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#在组件中使用-usereducer","aria-hidden":"true"},"#"),n(" 在组件中使用 useReducer")],-1),Gs=l(`<p>在组件里用：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">tasks</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">dispatch</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useReducer</span><span style="color:#24292E;">(tasksReducer, initialTasks);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,2),Qs=s("code",null,"const [tasks, setTasks] = useState(initialTasks)",-1),Ys={href:"https://react.dev/learn/extracting-state-logic-into-a-reducer",target:"_blank",rel:"noopener noreferrer"},$s=l(`<p>然后在事件处理器里调用 <code>dispatch(...)</code>。比如：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleAddTask</span><span style="color:#24292E;">(</span><span style="color:#E36209;">text</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">dispatch</span><span style="color:#24292E;">({ type: </span><span style="color:#032F62;">&#39;added&#39;</span><span style="color:#24292E;">, id: nextId</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">, text });</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Zs={href:"https://react.dev/learn/extracting-state-logic-into-a-reducer",target:"_blank",rel:"noopener noreferrer"},sn=s("hr",null,null,-1),nn=s("h2",{id:"_7-context",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_7-context","aria-hidden":"true"},"#"),n(" 7. Context")],-1),en=s("p",null,"Context 是一种“跨层级”传递数据的方式，避免中间组件的重复传递。",-1),an=s("p",null,[s("strong",null,"使用 Context 的典型场景"),n(" ：")],-1),ln={href:"https://react.dev/learn/passing-data-deeply-with-context",target:"_blank",rel:"noopener noreferrer"},on={href:"https://react.dev/learn/passing-data-deeply-with-context",target:"_blank",rel:"noopener noreferrer"},tn={href:"https://react.dev/learn/passing-data-deeply-with-context",target:"_blank",rel:"noopener noreferrer"},pn=s("li",null,[n("大型状态管理：结合 "),s("code",null,"useReducer + Context"),n(" 传递复杂状态至深层组件。")],-1),rn=l(`<h3 id="_1-创建-context" tabindex="-1"><a class="header-anchor" href="#_1-创建-context" aria-hidden="true">#</a> 1. 创建 Context</h3><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { createContext } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;react&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">LevelContext</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createContext</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),cn=s("code",null,"1",-1),dn={href:"https://react.dev/learn/passing-data-deeply-with-context",target:"_blank",rel:"noopener noreferrer"},un=l(`<blockquote><p>记住：<code>createContext(defaultValue)</code> 的 defaultValue 是有意义的，在没有 Provider 时也能有“兜底”的机制。</p></blockquote><h3 id="_2-在需要读取数据的组件中使用-usecontext" tabindex="-1"><a class="header-anchor" href="#_2-在需要读取数据的组件中使用-usecontext" aria-hidden="true">#</a> 2. 在需要读取数据的组件中使用 <code>useContext</code></h3><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useContext } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;react&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { LevelContext } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;./LevelContext&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Heading</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">children</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">level</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useContext</span><span style="color:#24292E;">(LevelContext);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// …</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),yn=s("code",null,"Heading",-1),vn=s("code",null,"level",-1),hn=s("code",null,"LevelContext",-1),mn=s("code",null,"LevelContext.Prodiver",-1),bn={href:"https://react.dev/learn/passing-data-deeply-with-context",target:"_blank",rel:"noopener noreferrer"},En=l(`<h3 id="_3-在提供数据的组件中使用-provider" tabindex="-1"><a class="header-anchor" href="#_3-在提供数据的组件中使用-provider" aria-hidden="true">#</a> 3. 在提供数据的组件中使用 Provider</h3><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { LevelContext } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;./LevelContext&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Section</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">level</span><span style="color:#24292E;">, </span><span style="color:#E36209;">children</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">section</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">className</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;section&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#005CC5;">LevelContext.Provider</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">value</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{level}&gt;</span></span>
<span class="line"><span style="color:#24292E;">        {children}</span></span>
<span class="line"><span style="color:#24292E;">      &lt;/</span><span style="color:#005CC5;">LevelContext.Provider</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">section</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样 <code>Section</code> 把 <code>level</code> 值“提供”给其下层所有用到 <code>LevelContext</code> 的组件</p><hr><h2 id="_8-ref" tabindex="-1"><a class="header-anchor" href="#_8-ref" aria-hidden="true">#</a> 8. Ref</h2><p>当一个组件希望 “记住（remember）” 某些信息，但 <strong>不希望这些信息的变化触发重新渲染（re-render）</strong> 时，就可以使用 <code>useRef()</code></p><h3 id="_1-导入-useref" tabindex="-1"><a class="header-anchor" href="#_1-导入-useref" aria-hidden="true">#</a> 1. 导入 useRef</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">import { useRef } from &#39;react&#39;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-在组件内部调用-指定初始值" tabindex="-1"><a class="header-anchor" href="#_2-在组件内部调用-指定初始值" aria-hidden="true">#</a> 2. 在组件内部调用，指定初始值</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">const myRef = useRef(0);</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,10),fn=s("code",null,"myRef.current",-1),gn=s("code",null,"0",-1),_n={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},An=l(`<h3 id="_3-访问或修改-ref-current" tabindex="-1"><a class="header-anchor" href="#_3-访问或修改-ref-current" aria-hidden="true">#</a> 3. 访问或修改 <code>ref.current</code></h3><p>例如：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">myRef.current = myRef.current + 1;</span></span>
<span class="line"><span style="color:#24292e;">alert(&#39;当前值：&#39; + myRef.current);</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,3),Cn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},xn=s("thead",null,[s("tr",null,[s("th",null,"特性"),s("th",null,[n("refs ("),s("code",null,"useRef"),n(")")]),s("th",null,[n("state ("),s("code",null,"useState"),n(")")])])],-1),Dn=s("td",null,"返回值",-1),kn=s("code",null,"{ current: initialValue }",-1),Fn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},Rn=s("code",null,"[value, setValue]",-1),In={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},jn=s("td",null,"变化是否触发渲染",-1),qn=s("strong",null,"不会",-1),Sn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},wn=s("strong",null,"会",-1),Pn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},Nn=s("td",null,"值是否可变",-1),Ln=s("code",null,"ref.current = ...",-1),Mn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},Hn=s("td",null,[n("“不可变”意义上，必须通过 "),s("code",null,"setValue(...)"),n(" 更新")],-1),Jn=s("td",null,"在渲染期间读取",-1),zn=s("code",null,"ref.current",-1),Xn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},Tn=s("td",null,"可以直接在渲染函数中读取 state，React 会正确追踪",-1),Vn=s("td",null,"用途",-1),Bn={href:"https://react.dev/learn/referencing-values-with-refs",target:"_blank",rel:"noopener noreferrer"},On=s("td",null,"存储会用于 UI 显示或决定渲染逻辑的数据（用户输入、是否展示、计数器等）",-1),Un=l(`<p>Ref 使用示例</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useRef } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;react&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Form</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">inputRef</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useRef</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">null</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handleClick</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    inputRef.current.</span><span style="color:#6F42C1;">focus</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">input</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{inputRef} /&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onClick</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{handleClick}&gt;</span></span>
<span class="line"><span style="color:#24292E;">        Focus the input</span></span>
<span class="line"><span style="color:#24292E;">      &lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Wn=s("strong",null,"为何需要 Refs（引用）？",-1),Kn={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},Gn={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},Qn=s("p",null,[s("strong",null,"如何获取 DOM 节点引用？")],-1),Yn=s("code",null,"useRef()",-1),$n=s("code",null,"const myRef = useRef(null);",-1),Zn={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},se=s("code",null,"ref={myRef}",-1),ne=s("code",null,"myRef.current",-1),ee={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},ae=s("code",null,"myRef.current",-1),le=s("code",null,"null",-1),oe={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},te=s("p",null,[s("strong",null,"何时使用 Refs？"),n(" 常见场景包括：")],-1),pe={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},re={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},ce=s("li",null,"测量元素大小、位置（getBoundingClientRect）",-1),ie={href:"https://react.dev/learn/manipulating-the-dom-with-refs",target:"_blank",rel:"noopener noreferrer"},de=s("hr",null,null,-1),ue=s("h2",{id:"_9-effect",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_9-effect","aria-hidden":"true"},"#"),n(" 9. Effect")],-1),ye=s("p",null,"在 React 里，组件主要做两件事：",-1),ve=s("strong",null,"渲染逻辑",-1),he=s("code",null,"props",-1),me=s("code",null,"state",-1),be={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},Ee=s("strong",null,"事件处理",-1),fe={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},ge=l(`<p>但是有一类事情比较尴尬： 它不是用户点了某个按钮才发生，而是 <strong>“只要组件出现在屏幕上，就应该发生”</strong> 。 比如：连接聊天室、播放视频、注册浏览器事件监听、埋点统计…… 这时候就轮到 <strong>Effect</strong> 上场了。</p><h3 id="例子-用-effect-控制-video-播放" tabindex="-1"><a class="header-anchor" href="#例子-用-effect-控制-video-播放" aria-hidden="true">#</a> 例子：用 Effect 控制 <code>&lt;video&gt;</code> 播放</h3><p>假设我们有一个简单的视频播放器组件，希望通过 <code>isPlaying</code> 控制它是「播放」还是「暂停」：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useEffect, useRef } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VideoPlayer</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">src</span><span style="color:#24292E;">, </span><span style="color:#E36209;">isPlaying</span><span style="color:#24292E;"> }) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">videoRef</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useRef</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">null</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">useEffect</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">video</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> videoRef.current;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">video) </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (isPlaying) {</span></span>
<span class="line"><span style="color:#24292E;">      video.</span><span style="color:#6F42C1;">play</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      video.</span><span style="color:#6F42C1;">pause</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }, [isPlaying]); </span><span style="color:#6A737D;">// 只有 isPlaying 变化时才重新同步</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">video</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{videoRef} </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{src} </span><span style="color:#6F42C1;">loop</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">playsInline</span><span style="color:#24292E;"> /&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>外层再包一层按钮切换状态：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { useState } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">App</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">isPlaying</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setIsPlaying</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onClick</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setIsPlaying</span><span style="color:#24292E;">(</span><span style="color:#E36209;">p</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">p)}&gt;</span></span>
<span class="line"><span style="color:#24292E;">        {isPlaying </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;暂停&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;播放&quot;</span><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">      &lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#005CC5;">VideoPlayer</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">src</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">isPlaying</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{isPlaying}</span></span>
<span class="line"><span style="color:#24292E;">      /&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/&gt;</span></span>
<span class="line"><span style="color:#24292E;">  );</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里发生了几件事：</p>`,7),_e=s("li",null,[n("组件渲染时，只是返回了一个带 "),s("code",null,"ref"),n(" 的 "),s("code",null,"<video>"),n(" 标签 —— "),s("strong",null,"渲染本身不碰 DOM API"),n(" 。")],-1),Ae=s("li",null,"React 把这段 JSX “提交（commit）”到真实 DOM 上。",-1),Ce=s("code",null,"useEffect",-1),xe=s("code",null,"video.play()",-1),De=s("code",null,"video.pause()",-1),ke={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},Fe=l(`<p>用一句话总结：</p><blockquote><p><strong>Effect = 渲染之后，用当前的 props/state 去“同步”外部系统的状态。</strong></p></blockquote><h3 id="为什么需要依赖数组" tabindex="-1"><a class="header-anchor" href="#为什么需要依赖数组" aria-hidden="true">#</a> 为什么需要依赖数组？</h3><p>如果不给 <code>useEffect</code> 传依赖数组：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">useEffect</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那它会在 <strong>每一次渲染后都执行</strong> 。有时这会：</p>`,6),Re={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},Ie=s("li",null,"行为错误：比如每次渲染都重新触发一次「淡入动画」。",-1),je=l(`<p>所以我们通常会像上面的例子一样传入依赖数组：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">useEffect</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 根据 isPlaying 同步视频状态</span></span>
<span class="line"><span style="color:#24292E;">}, [isPlaying]);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>含义是： <strong>只有当 <code>isPlaying</code> 发生变化时，才需要再次运行这个 Effect</strong> 。</p><h3 id="一个经典坑-在-effect-里直接-setstate" tabindex="-1"><a class="header-anchor" href="#一个经典坑-在-effect-里直接-setstate" aria-hidden="true">#</a> 一个经典坑：在 Effect 里直接 setState</h3>`,4),qe={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},Se=l(`<div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">count</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">setCount</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useState</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">useEffect</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">setCount</span><span style="color:#24292E;">(count </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发生了什么？</p><ol><li>组件渲染完，Effect 运行，<code>setCount(count + 1)</code>。</li><li>状态变了，又触发一次渲染。</li><li>渲染完又运行 Effect，再次 <code>setCount</code>……</li><li>无限循环 🔄，页面直接炸掉。</li></ol><p>记住一条经验：</p>`,4),we=s("strong",null,"Effect 更适合“和外部世界同步”，而不是在内部“纯粹改 state”。 如果只是想根据一个 state 推出另一个 state，通常可以用计算属性或在事件里处理，而不是上来就写 Effect。",-1),Pe={href:"https://react.dev/learn/synchronizing-with-effects",target:"_blank",rel:"noopener noreferrer"},Ne=s("hr",null,null,-1),Le=s("h2",{id:"_10-react-生命周期",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_10-react-生命周期","aria-hidden":"true"},"#"),n(" 10. React 生命周期")],-1),Me=s("p",null,[n("在 React 中，我们通常熟悉组件的生命周期：组件会挂载（mount）、更新（update）、卸载（unmount）。但当你使用 React Hooks 中的 "),s("code",null,"useEffect"),n("、或其他 “副作用” 时，其实需要换一种视角来看 — "),s("strong",null,"每一个 Effect（副作用）本身也有自己的“同步启动／停止”过程"),n(" 。文档指出：")],-1),He={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},Je=l(`<h3 id="核心示例-chatroom" tabindex="-1"><a class="header-anchor" href="#核心示例-chatroom" aria-hidden="true">#</a> 核心示例：ChatRoom</h3><p>文档中给了一个非常直观的示例：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">const serverUrl = &#39;https://localhost:1234&#39;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">function ChatRoom({ roomId }) {</span></span>
<span class="line"><span style="color:#24292e;">  useEffect(() =&gt; {</span></span>
<span class="line"><span style="color:#24292e;">    const connection = createConnection(serverUrl, roomId);</span></span>
<span class="line"><span style="color:#24292e;">    connection.connect();</span></span>
<span class="line"><span style="color:#24292e;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#24292e;">      connection.disconnect();</span></span>
<span class="line"><span style="color:#24292e;">    };</span></span>
<span class="line"><span style="color:#24292e;">  }, [roomId]);</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">  return &lt;h1&gt;Welcome to the {roomId} room!&lt;/h1&gt;;</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),ze={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},Xe=l('<h3 id="为什么不仅仅是-挂载-卸载" tabindex="-1"><a class="header-anchor" href="#为什么不仅仅是-挂载-卸载" aria-hidden="true">#</a> 为什么不仅仅是“挂载／卸载”？</h3><p>假设用户最初进入 <code>&quot;general&quot;</code> room，然后切换到 <code>&quot;travel&quot;</code> room。组件并没有卸载——只是 <code>roomId</code> 这个 prop 发生了变化。那 Effect 应该怎么做？</p><ol><li>停止同步旧的 roomId （断开 “general” 连接）</li><li>启动同步新的 roomId （连接 “travel”） 文档里描述：</li></ol>',3),Te=s("code",null,"roomId",-1),Ve=s("code",null,"roomId",-1),Be={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},Oe=s("hr",null,null,-1),Ue=s("h3",{id:"从-effect-角度思考",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#从-effect-角度思考","aria-hidden":"true"},"#"),n(" 从 Effect 角度思考")],-1),We=s("p",null,"文档强调一种思考方式：",-1),Ke={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},Ge=s("code",null,"useEffect",-1),Qe=l('<ul><li>当这个 Effect 启动（synchronize）时，我该做什么？</li><li>当这个 Effect 停止（cleanup）时，我该做什么？</li></ul><p>在上面 ChatRoom 的例子里：</p><ul><li>启动 → <code>createConnection(...).connect()</code></li><li>停止 → <code>connection.disconnect()</code></li></ul><p>无论是因为 roomId 变了，还是组件卸载了，这两个流程都要被正确执行。</p><hr><h3 id="依赖数组-dependencies-要点" tabindex="-1"><a class="header-anchor" href="#依赖数组-dependencies-要点" aria-hidden="true">#</a> 依赖数组（Dependencies）要点</h3><p>Effect 的行为关键还在于依赖数组：<code>[]</code> 或 <code>[roomId]</code> 等。文档指出：</p>',7),Ye={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},$e=s("code",null,"roomId",-1),Ze=s("code",null,"[roomId]",-1),sa=s("code",null,"serverUrl = 'https://localhost:1234'",-1),na={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},ea=l(`<p>如果你把所有用到的 reactive 值都“移出”组件或 effect 内部（即变成常量），那就可以用空数组 <code>[]</code>，表示“只启动一次、停止一次”。例如：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">const serverUrl = &#39;https://localhost:1234&#39;;</span></span>
<span class="line"><span style="color:#24292e;">const roomId = &#39;general&#39;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">function ChatRoom() {</span></span>
<span class="line"><span style="color:#24292e;">  useEffect(() =&gt; {</span></span>
<span class="line"><span style="color:#24292e;">    const connection = createConnection(serverUrl, roomId);</span></span>
<span class="line"><span style="color:#24292e;">    connection.connect();</span></span>
<span class="line"><span style="color:#24292e;">    return () =&gt; connection.disconnect();</span></span>
<span class="line"><span style="color:#24292e;">  }, []);</span></span>
<span class="line"><span style="color:#24292e;">  return &lt;h1&gt;Welcome to the {roomId} room!&lt;/h1&gt;;</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),aa={href:"https://react.dev/learn/lifecycle-of-reactive-effects",target:"_blank",rel:"noopener noreferrer"},la=l('<hr><h3 id="小结" tabindex="-1"><a class="header-anchor" href="#小结" aria-hidden="true">#</a> 小结</h3><ul><li>每个 Effect 是一个“同步过程”：启动→运行→停止，而不是简单绑定组件生命周期。</li><li>当你写 <code>useEffect(() =&gt; { … }, [deps])</code> 时，要思考 “我什么时候启动”“我什么时候停止”这个同步。</li><li>依赖数组的每一个值都必须是你在 Effect 内读取的、且可能变的 reactive 值。漏掉就容易出 bug。</li><li>用空依赖（<code>[]</code>）意味着 “组件挂载时启动，同卸载时停止；中间不随 prop/state 变动而重新同步”。</li><li>用非空依赖（如 <code>[roomId]</code>）意味着 “只要某个关键值变了，就停止旧同步、启动新同步”。</li></ul><hr><h2 id="_11-hook" tabindex="-1"><a class="header-anchor" href="#_11-hook" aria-hidden="true">#</a> 11. Hook</h2>',5),oa=s("strong",null,"可复用的、有状态的逻辑",-1),ta={href:"https://react.dev/learn/reusing-logic-with-custom-hooks?utm_source=chatgpt.com",target:"_blank",rel:"noopener noreferrer"},pa=l(`<h3 id="例子-把表单输入的重复逻辑抽出来" tabindex="-1"><a class="header-anchor" href="#例子-把表单输入的重复逻辑抽出来" aria-hidden="true">#</a> 例子：把表单输入的重复逻辑抽出来</h3><p>先看一个没有自定义 Hook 的 <code>Form</code> 组件：它对 firstName/lastName 两个输入框分别维护 state，并写两个几乎一样的 onChange 处理函数。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">import { useState } from &quot;react&quot;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">export default function Form() {</span></span>
<span class="line"><span style="color:#24292e;">  const [firstName, setFirstName] = useState(&quot;Mary&quot;);</span></span>
<span class="line"><span style="color:#24292e;">  const [lastName, setLastName] = useState(&quot;Poppins&quot;);</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">  return (</span></span>
<span class="line"><span style="color:#24292e;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;label&gt;</span></span>
<span class="line"><span style="color:#24292e;">        First name:</span></span>
<span class="line"><span style="color:#24292e;">        &lt;input</span></span>
<span class="line"><span style="color:#24292e;">          value={firstName}</span></span>
<span class="line"><span style="color:#24292e;">          onChange={(e) =&gt; setFirstName(e.target.value)}</span></span>
<span class="line"><span style="color:#24292e;">        /&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;/label&gt;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">      &lt;label&gt;</span></span>
<span class="line"><span style="color:#24292e;">        Last name:</span></span>
<span class="line"><span style="color:#24292e;">        &lt;input</span></span>
<span class="line"><span style="color:#24292e;">          value={lastName}</span></span>
<span class="line"><span style="color:#24292e;">          onChange={(e) =&gt; setLastName(e.target.value)}</span></span>
<span class="line"><span style="color:#24292e;">        /&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;/label&gt;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">      &lt;p&gt;&lt;b&gt;Good morning, {firstName} {lastName}.&lt;/b&gt;&lt;/p&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;/&gt;</span></span>
<span class="line"><span style="color:#24292e;">  );</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重复点很明显：</p><ul><li>每个字段都要一份 state</li><li>每个字段都要一个 change handler</li><li>每个 input 都要写 <code>value</code> 和 <code>onChange</code></li></ul><p>于是我们可以提炼出一个 <code>useFormInput</code>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">import { useState } from &quot;react&quot;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">export function useFormInput(initialValue) {</span></span>
<span class="line"><span style="color:#24292e;">  const [value, setValue] = useState(initialValue);</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">  function handleChange(e) {</span></span>
<span class="line"><span style="color:#24292e;">    setValue(e.target.value);</span></span>
<span class="line"><span style="color:#24292e;">  }</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">  return {</span></span>
<span class="line"><span style="color:#24292e;">    value,</span></span>
<span class="line"><span style="color:#24292e;">    onChange: handleChange,</span></span>
<span class="line"><span style="color:#24292e;">  };</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后 <code>Form</code> 变得更干净：我们只声明“我要两个输入框”，至于输入框怎么同步 state，由 Hook 内部处理。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292e;">import { useFormInput } from &quot;./useFormInput&quot;;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">export default function Form() {</span></span>
<span class="line"><span style="color:#24292e;">  const firstNameProps = useFormInput(&quot;Mary&quot;);</span></span>
<span class="line"><span style="color:#24292e;">  const lastNameProps = useFormInput(&quot;Poppins&quot;);</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">  return (</span></span>
<span class="line"><span style="color:#24292e;">    &lt;&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;label&gt;</span></span>
<span class="line"><span style="color:#24292e;">        First name:</span></span>
<span class="line"><span style="color:#24292e;">        &lt;input {...firstNameProps} /&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;/label&gt;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">      &lt;label&gt;</span></span>
<span class="line"><span style="color:#24292e;">        Last name:</span></span>
<span class="line"><span style="color:#24292e;">        &lt;input {...lastNameProps} /&gt;</span></span>
<span class="line"><span style="color:#24292e;">      &lt;/label&gt;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">      &lt;p&gt;&lt;b&gt;Good morning, {firstNameProps.value} {lastNameProps.value}.&lt;/b&gt;&lt;/p&gt;</span></span>
<span class="line"><span style="color:#24292e;">    &lt;/&gt;</span></span>
<span class="line"><span style="color:#24292e;">  );</span></span>
<span class="line"><span style="color:#24292e;">}</span></span>
<span class="line"><span style="color:#24292e;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里最重要的点：</p><ul><li><code>useFormInput</code> 只写了一份逻辑</li><li><code>Form</code> 调了两次 <code>useFormInput</code></li><li>所以得到的是两份 <strong>互不影响</strong> 的 state（firstName 的输入不会改 lastName）。</li></ul>`,11),ra={href:"https://react.dev/learn/reusing-logic-with-custom-hooks?utm_source=chatgpt.com",target:"_blank",rel:"noopener noreferrer"},ca=l('<hr><h3 id="小结-1" tabindex="-1"><a class="header-anchor" href="#小结-1" aria-hidden="true">#</a> 小结</h3><p>当你发现组件里出现可重复的 stateful 逻辑时：</p><ol><li>先确认它确实包含 Hook（比如 <code>useState/useEffect</code>）</li><li>再把重复部分抽成 <code>useXxx</code></li><li>让组件只表达意图，逻辑细节交给 Hook</li></ol><p>自定义 Hook 的价值就在于：让你的组件更像“声明式的 UI”，而不是“到处散落着重复的实现细节”。</p>',5);function ia(da,ua){const e=t("ExternalLinkIcon");return p(),r("div",null,[d,u,c("more"),y,s("blockquote",null,[s("p",null,[n("v7 的理念： "),v,n(" ；同时 v7 保持与 v6 的非破坏升级，并向 React 19 的服务端能力过渡。"),s("a",h,[n("React Router"),a(e)])])]),m,s("p",null,[n("在 "),b,n(" 组件上，我们传递了两个 props："),E,n("（一个对象）和 "),f,n("（一个数字）"),s("a",g,[n("React"),a(e)])]),_,s("ul",null,[s("li",null,[A,n(" 是传统形式；而 "),C,n(" 是通过 "),x,n(" （destructuring）来直接获取所需属性。 "),s("a",D,[n("React"),a(e)])]),k]),F,s("p",null,[n("在这个用法中，"),R,n(" 被当作 "),I,n(" 的 "),j,n("，使 "),q,n(" 能包裹任意内容。 "),s("a",S,[n("React"),a(e)]),n(" 这是构建可组合 UI 组件（Panel、Wrapper、布局容器等）非常常见的模式。")]),w,s("p",null,[n("如果直接复制到 JSX 中，会报错。原因是 JSX 有一些更严格或不同的规则。 "),s("a",P,[n("React"),a(e)])]),N,s("ul",null,[s("li",null,[n("在 React 中，用 JavaScript 控制分支逻辑（if、? :、&&）。 "),s("a",L,[n("React"),a(e)])]),s("li",null,[M,n(" 表示“如果 cond 渲染 A，否则 B”。 "),s("a",H,[n("React"),a(e)])]),s("li",null,[J,n(" 表示“如果 cond 渲染 A，否则什么都不渲染”。 "),s("a",z,[n("React"),a(e)])]),s("li",null,[n("虽然快捷语法常见，但也可以回到最基础的 if 语句，以确保清晰。 "),s("a",X,[n("React"),a(e)])])]),T,s("ul",null,[s("li",null,[n("将数据从组件中抽离出来（用数组／对象）。 "),s("a",V,[n("React"),a(e)])]),s("li",null,[n("使用 "),B,n(" 对数据进行转换 → 渲染成多个组件／元素。 "),s("a",O,[n("React"),a(e)])]),s("li",null,[n("使用 "),U,n(" 可以先筛选一部分数据，再渲染。 "),s("a",W,[n("React"),a(e)])]),s("li",null,[n("每个列表项要设置 "),K,n(" 属性，保证 React 能正确追踪。 "),s("a",G,[n("React"),a(e)])])]),Q,Y,$,s("p",null,[n("在 JSX 元素上通过像 "),Z,n(" 的 prop 来传入一个函数。 "),s("a",ss,[n("React+1"),a(e)])]),ns,s("ol",null,[es,as,s("li",null,[n("在 JSX 中 "),ls,n("。 "),s("a",os,[n("React"),a(e)])])]),s("p",null,[n("函数可以定义在组件里，也可以用内联（inline）匿名函数或箭头函数。 "),s("a",ts,[n("React"),a(e)])]),ps,s("ul",null,[s("li",null,[n("只能在函数组件的最顶层调用，不能在循环、条件或嵌套函数里调用。"),s("a",rs,[n("React"),a(e)])]),cs]),is,s("p",null,[ds,n(" 使用 "),us,n(" 等会改变原数组的方法。 "),s("a",ys,[n("React+1"),a(e)]),vs,n(" 使用扩展运算符（spread）和/或 "),hs,n(" 创建新数组。示例：")]),ms,s("p",null,[n("上述方法会生成一个新的数组引用，从而触发 React 重新渲染。 "),s("a",bs,[n("React"),a(e)])]),Es,s("p",null,[n("这样得到的是一个 "),fs,n(" ，原数组不被修改。 "),s("a",gs,[n("React"),a(e)])]),_s,s("p",null,[n("这种方式保证 “数组引用” 和 “被替换对象” 都是新的。否则如果你只是修改旧对象，就会和旧状态共享对象引用，可能引发难以察觉的 bug。 "),s("a",As,[n("React"),a(e)])]),Cs,s("p",null,[n("这里 "),xs,n(" 返回的是一个新的子数组，因此你在拼出新的数组时也是在构造一个新的结构。 "),s("a",Ds,[n("React"),a(e)])]),ks,Fs,s("ul",null,[s("li",null,[n("方法如 "),Rs,n("、"),Is,n(" 会 "),js,n(" ，如果直接在 state 的数组上调用，会破坏不可变原则。推荐先做 "),qs,n("，然后 "),Ss,n(" 或 "),ws,n("，最后 "),Ps,n("。 "),s("a",Ns,[n("React"),a(e)])]),s("li",null,[n("注意：即便你复制了数组（如 "),Ls,n("），如果数组元素是对象，那么这些对象还是旧的引用。如果你修改了其中某个对象的属性，也可能是直接修改原对象，仍然会破坏 state 的不可变性。文档举了一个例子：拷贝数组但未深拷贝对象，结果两个状态 hook 共享对象引用，操作一个会影响另一个。 "),s("a",Ms,[n("React"),a(e)])])]),Hs,Js,zs,Xs,s("ul",null,[s("li",null,[s("p",null,[Ts,n(" 函数签名通常为 "),Vs,n("。 "),s("a",Bs,[n("React"),a(e)])])]),s("li",null,[Os,s("p",null,[s("a",Us,[n("React"),a(e)])])]),s("li",null,[s("p",null,[n("写好之后，可以把它提取到组件外部或独立文件，使组件更简洁。 "),s("a",Ws,[n("React"),a(e)])])])]),Ks,s("ul",null,[s("li",null,[Gs,s("p",null,[n("替代之前的 "),Qs,n("。 "),s("a",Ys,[n("React"),a(e)])])]),s("li",null,[$s,s("p",null,[s("a",Zs,[n("React"),a(e)])])])]),sn,nn,en,an,s("ul",null,[s("li",null,[n("主题（theme）：全局颜色、暗黑模式等。"),s("a",ln,[n("React"),a(e)])]),s("li",null,[n("当前用户 (current account / auth)：很多组件可能需要知道登录状态或用户信息。"),s("a",on,[n("React"),a(e)])]),s("li",null,[n("路由状态：其实路由库本身就用 context 来实现的。"),s("a",tn,[n("React"),a(e)])]),pn]),rn,s("p",null,[n("这里 "),cn,n(" 是默认值，当组件在树中“没有”被对应的 Provider 包裹时，会用这个默认值。"),s("a",dn,[n("React"),a(e)])]),un,s("p",null,[n("这样 "),yn,n(" 就不再依赖自己被传 "),vn,n(" prop，而是“自己去找”最近的 "),hn,n(" 提供者（根据当前 component 所在位置，往父组件方向寻找 "),mn,n("）。"),s("a",bn,[n("React"),a(e)])]),En,s("p",null,[n("这里 "),fn,n(" 初始为 "),gn,n("。 "),s("a",_n,[n("React"),a(e)])]),An,s("p",null,[n("此操作不会导致组件重新渲染（除非你自己用 state 做更新）––因此，用来存储 “渲染之外的可变值” 十分合适。 "),s("a",Cn,[n("React"),a(e)])]),s("table",null,[xn,s("tbody",null,[s("tr",null,[Dn,s("td",null,[kn,n(" 对象 ("),s("a",Fn,[n("React"),a(e)]),n(")")]),s("td",null,[Rn,n(" 数组 ("),s("a",In,[n("React"),a(e)]),n(")")])]),s("tr",null,[jn,s("td",null,[qn,n(" ("),s("a",Sn,[n("React"),a(e)]),n(")")]),s("td",null,[wn,n(" ("),s("a",Pn,[n("React"),a(e)]),n(")")])]),s("tr",null,[Nn,s("td",null,[n("可变（你可以直接写 "),Ln,n("） ("),s("a",Mn,[n("React"),a(e)]),n(")")]),Hn]),s("tr",null,[Jn,s("td",null,[n("不推荐在渲染过程中读取／写入 "),zn,n("，因为 React 无法追踪它，可能导致不可预测行为。 ("),s("a",Xn,[n("React"),a(e)]),n(")")]),Tn]),s("tr",null,[Vn,s("td",null,[n("存储：定时器 ID、浏览器 APIs、DOM 元素引用、过程状态等，不影响 UI 渲染。 ("),s("a",Bn,[n("React"),a(e)]),n(")")]),On])])]),Un,s("p",null,[Wn,n(" React 默认负责更新 DOM，以匹配组件输出。通常你不需要手动操作 DOM。但在某些情形（如：让输入框自动聚焦、滚动到某个元素、测量元素尺寸/位置）下，就需要获取 React 管理的 DOM 节点。 "),s("a",Kn,[n("React"),a(e)]),n(" 在这些情况下，就可以用 “ref” 来访问 DOM 节点并调用浏览器原生 API。 "),s("a",Gn,[n("React"),a(e)])]),Qn,s("ul",null,[s("li",null,[n("使用 "),Yn,n(" Hook 创建一个 ref 对象（例如 "),$n,n("） "),s("a",Zn,[n("React"),a(e)])]),s("li",null,[n("在 JSX 元素上加上 "),se,n("，React 在 commit 阶段会把该 DOM 节点赋值给 "),ne,n("。 "),s("a",ee,[n("React"),a(e)])]),s("li",null,[n("注意：在 render 阶段 "),ae,n(" 可能仍为 "),le,n("，因为 DOM 节点尚未创建或尚未更新。"),s("a",oe,[n("React"),a(e)])])]),te,s("ul",null,[s("li",null,[n("让输入框聚焦（focus） "),s("a",pe,[n("React"),a(e)])]),s("li",null,[n("滚动到某个元素（scrollIntoView） "),s("a",re,[n("React"),a(e)])]),ce,s("li",null,[n("或者调用浏览器 API（如 video 的 play/pause） "),s("a",ie,[n("React"),a(e)]),n(" 也就是说，Refs 是一种 “逃生舱”（escape hatch）——在 React 控制之外需要直接操作 DOM 时才用。")])]),de,ue,ye,s("ul",null,[s("li",null,[ve,n(" ：根据 "),he,n(" 和 "),me,n(" 计算出要返回的 JSX（必须是“纯函数”——只算结果，不做副作用）。"),s("a",be,[n("React"),a(e)])]),s("li",null,[Ee,n(" ：响应用户点击、输入等事件，去发请求、更新状态、跳转页面，这些都是“副作用”。"),s("a",fe,[n("React"),a(e)])])]),ge,s("ol",null,[_e,Ae,s("li",null,[n("提交结束后，React 才调用 "),Ce,n(" 里的回调，在那里我们用 "),xe,n("/"),De,n(" 去操作真实 DOM。"),s("a",ke,[n("React"),a(e)])])]),Fe,s("ul",null,[s("li",null,[n("性能不好：比如每次输入都重新连一次服务器。"),s("a",Re,[n("React"),a(e)])]),Ie]),je,s("p",null,[n("看下面这段“反例”代码（简化自文档）："),s("a",qe,[n("React"),a(e)])]),Se,s("blockquote",null,[s("p",null,[we,s("a",Pe,[n("React"),a(e)])])]),Ne,Le,Me,s("blockquote",null,[s("p",null,[n("“Effects have a different lifecycle from components… An Effect can only do two things: to start synchronizing something, and later to stop synchronizing it.” "),s("a",He,[n("React"),a(e)]),n(" 也就是说：我们不再单纯去想“组件何时挂载／更新／卸载”，而是去想：“这个 Effect 是什么时候开始同步？什么时候停止同步？”。")])]),Je,s("p",null,[n("这个例子帮助我们理解 Effect 的“启动”（connect）与“清理／停止”（disconnect）机制。 "),s("a",ze,[n("React"),a(e)])]),Xe,s("blockquote",null,[s("p",null,[n("“At this point, you want React to do two things: 1. Stop synchronizing with the old "),Te,n(" … 2. Start synchronizing with the new "),Ve,n(".” "),s("a",Be,[n("React"),a(e)]),n(" 这正说明：Effect 的同步并非只在挂载或卸载时触发一次，而可能在组件仍然挂载的状态下反复 “停止旧的→启动新的”。")])]),Oe,Ue,We,s("blockquote",null,[s("p",null,[n("“Instead, always focus on a single start/stop cycle at a time. … All you need to do is to describe how to start synchronization and how to stop it.” "),s("a",Ke,[n("React"),a(e)]),n(" 也就是说：你写 "),Ge,n(" 时，别总想着 “组件什么时候挂载／更新／卸载”。而直接问自己两个问题：")])]),Qe,s("ul",null,[s("li",null,[s("p",null,[n("如果你在 Effect 内读取了一个可能随渲染改变的值（即“reactive value”），就必须把它放进依赖数组。 "),s("a",Ye,[n("React+1"),a(e)])])]),s("li",null,[s("p",null,[n("在前例中，"),$e,n(" 是 prop，会变，因此放 "),Ze,n("。而 "),sa,n(" 是一个固定常量，不会变，因此不必放进数组。 "),s("a",na,[n("React"),a(e)])])]),s("li",null,[ea,s("p",null,[s("a",aa,[n("React"),a(e)])])])]),la,s("p",null,[n("写 React 的时候，你经常会遇到“两个地方做了同一件事”的情况：有一段 state + handler + JSX 逻辑，在一个组件里出现两次，或者在多个组件里重复。官方的建议是：把 "),oa,n(" 抽成自定义 Hook。注意这里的关键词是“逻辑”，不是“状态”——每次调用 Hook 都会创建自己独立的一份 state。 "),s("a",ta,[n("React"),a(e)])]),pa,s("p",null,[n("这正是“复用逻辑，不复用状态”的含义。 "),s("a",ra,[n("React"),a(e)])]),ca])}const ha=o(i,[["render",ia],["__file","笔记react.html.vue"]]);export{ha as default};
