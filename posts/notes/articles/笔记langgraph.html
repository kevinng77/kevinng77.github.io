<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="http://antarina.tech/posts/notes/articles/%E7%AC%94%E8%AE%B0langgraph.html"><meta property="og:site_name" content="记忆笔书"><meta property="og:title" content="langgraph"><meta property="og:description" content="langgraph agent 架构思路 单个 agent 的实现方式 多个 agent 的交互方式 多 agent 系统的实现方式 可复用模块整理 基础 agent 模块（没有 memory 调整） --- title: 基础 agent 模块 --- flowchart TB 	subgraph core 	system_prompt --&gt; llm 	end 	 core --&gt; tool tool--&gt; core core --&gt; __end__"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-05T03:34:03.000Z"><meta property="article:author" content="吴嘉文 Kevin"><meta property="article:modified_time" content="2024-07-05T03:34:03.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"langgraph","image":[""],"dateModified":"2024-07-05T03:34:03.000Z","author":[{"@type":"Person","name":"吴嘉文 Kevin","url":"http://antarina.tech/"}]}</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet"><link rel="icon" href="/logo.svg"><title>langgraph | 记忆笔书</title><meta name="description" content="langgraph agent 架构思路 单个 agent 的实现方式 多个 agent 的交互方式 多 agent 系统的实现方式 可复用模块整理 基础 agent 模块（没有 memory 调整） --- title: 基础 agent 模块 --- flowchart TB 	subgraph core 	system_prompt --&gt; llm 	end 	 core --&gt; tool tool--&gt; core core --&gt; __end__">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-a733c29d.css" as="style"><link rel="stylesheet" href="/assets/style-a733c29d.css">
    <link rel="modulepreload" href="/assets/app-e8d04472.js"><link rel="modulepreload" href="/assets/笔记langgraph.html-81d29bca.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/笔记langgraph.html-bdec2dac.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><!----><!----><span class="vp-site-name">记忆笔书</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="主页" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="归档" class="vp-link nav-link nav-link" href="/timeline/"><span class="font-icon icon iconfont icon-categoryselected" style=""></span>归档<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/kevinng77" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->langgraph</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="http://antarina.tech/" target="_blank" rel="noopener noreferrer">吴嘉文 Kevin</a></span><span property="author" content="吴嘉文 Kevin"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-05T03:34:03.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 3 分钟</span><meta property="timeRequired" content="PT3M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#可复用模块整理">可复用模块整理</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#langchain-tool-call-方式">langchain tool call 方式</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="langgraph" tabindex="-1"><a class="header-anchor" href="#langgraph" aria-hidden="true">#</a> langgraph</h1><p>agent 架构思路</p><ol><li>单个 agent 的实现方式</li><li>多个 agent 的交互方式</li><li>多 agent 系统的实现方式</li></ol><h2 id="可复用模块整理" tabindex="-1"><a class="header-anchor" href="#可复用模块整理" aria-hidden="true">#</a> 可复用模块整理</h2><ol><li>基础 agent 模块（没有 memory 调整）</li></ol><div class="language-mermaid line-numbers-mode" data-ext="mermaid"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">---</span></span>
<span class="line"><span style="color:#24292E;">title: 基础 agent 模块</span></span>
<span class="line"><span style="color:#24292E;">---</span></span>
<span class="line"><span style="color:#D73A49;">flowchart</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">subgraph</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">core</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#E36209;">system_prompt </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">llm</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">core </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">tool</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">tool</span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">core</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">core </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">__end__</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> langchain_core.prompts </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> ChatPromptTemplate</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> langchain_core.pydantic_v1 </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> BaseModel, Field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 定义输出格式</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Plan</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">BaseModel</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;Plan to follow in future&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    steps: List[</span><span style="color:#005CC5;">str</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;different steps to follow, should be in sorted order&quot;</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">   </span></span>
<span class="line"><span style="color:#6A737D;"># 定义 prompt</span></span>
<span class="line"><span style="color:#24292E;">planner_prompt </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ChatPromptTemplate.from_messages(</span></span>
<span class="line"><span style="color:#24292E;">    [</span></span>
<span class="line"><span style="color:#24292E;">        (</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;&quot;&quot;your prompt&quot;&quot;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        ),</span></span>
<span class="line"><span style="color:#24292E;">        (</span><span style="color:#032F62;">&quot;placeholder&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{messages}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 定义 agent 基础</span></span>
<span class="line"><span style="color:#24292E;">planner </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> planner_prompt </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> ChatOpenAI(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">model</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;gpt-4o&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">temperature</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">).bind_tools(tools).with_structured_output(Plan)  </span></span>
<span class="line"><span style="color:#6A737D;"># with_structured_output 就是用 llm bind 以下 plan，然后用 plan 执行了一下 AI 返回的 tool_call 参数。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>单个 LLM 对多个 tool node</li></ol><div class="language-mermaid line-numbers-mode" data-ext="mermaid"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">---</span></span>
<span class="line"><span style="color:#24292E;">title: 单个 LLM 对多个 tool node</span></span>
<span class="line"><span style="color:#24292E;">---</span></span>
<span class="line"><span style="color:#D73A49;">flowchart</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TB</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">subgraph</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">core</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#E36209;">system_prompt </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">llm</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">subgraph</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Tools</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#E36209;">tool1</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#E36209;">tool2</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">core </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">Tools</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">Tools</span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">core</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">core </span><span style="color:#D73A49;">--&gt;</span><span style="color:#24292E;"> </span><span style="color:#E36209;">__end__</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>多业务，多 agent 服务用户架构</li></ol><p>参考 https://langchain-ai.github.io/langgraph/tutorials/customer-support/customer-support/#utility。</p><p>低层采用的 GPT 的 name 机制发送 API，实现多角色对话，比如要实现 researcher 和 chart_generator 对话的话，可以在 API 的 payload 中发送一下 messages:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">[{</span><span style="color:#032F62;">&#39;content&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Fetch the UK&#39;s GDP over the past 5 years, then draw a line graph of it. Once you code it up, finish.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;role&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;user&#39;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">  {</span><span style="color:#032F62;">&#39;content&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;The search results provide some information about the UK&#39;s GDP over the past years, but most of the relevant data is either not in a structured format that can be easily extracted or it is behind a source that requires further access for detailed statistics. To proceed with generating a line graph, we need specific GDP values for each year from 2018 to 2023.</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">However, one of the search results from macrotrends.net does provide specific GDP values for the years 2018 to 2021:</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">- U.K. GDP for 2021 was $3,141.51 billion, a 16.45</span><span style="color:#005CC5;">% i</span><span style="color:#032F62;">ncrease from 2020.</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">- U.K. GDP for 2020 was $2,697.81 billion, a 5.39</span><span style="color:#005CC5;">% d</span><span style="color:#032F62;">ecline from 2019.</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">- U.K. GDP for 2019 was $2,851.41 billion, a 0.69</span><span style="color:#005CC5;">% d</span><span style="color:#032F62;">ecline from 2018.</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">We still need the GDP values for 2022 and 2023 to complete the dataset for the past five years. I will now conduct a further search to find the missing GDP data for 2022 and 2023.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;Researcher&#39;</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;"># 记得提供不同角色的名字</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;role&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;assistant&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;tool_calls&#39;</span><span style="color:#24292E;">: [{</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;call_nvB1wQyQuNeTrOXQZnEtgNDZ&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;tavily_search_results_json&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#032F62;">&#39;arguments&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;{&quot;query&quot;: &quot;UK GDP 2022 2023&quot;}&#39;</span><span style="color:#24292E;">}}]},</span></span>
<span class="line"><span style="color:#24292E;">  {</span><span style="color:#032F62;">&#39;content&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;The search results did not provide exact figures for the UK&#39;s GDP in 2022 and 2023. While there are several references to GDP data, growth rates, and quarterly figures, we do not have the specific annual GDP values in a consistent currency format (such as USD or GBP) that would allow us to compile a complete dataset for the past five years.</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">To proceed, we will need to find another source or use a different method to obtain the missing GDP data for 2022 and 2023. If this data is not available, we may not be able to draw an accurate line graph of the UK&#39;s GDP over the past five years.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;Researcher&#39;</span><span style="color:#24292E;">,   </span><span style="color:#6A737D;"># 记得提供不同角色的名字</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;role&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;assistant&#39;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">  {</span><span style="color:#032F62;">&#39;content&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;It seems we have hit a roadblock in finding the exact GDP figures for the UK for the years 2022 and 2023. The information provided by the search results does not include the specific data we need. Therefore, we currently do not have the complete dataset to generate a line graph of the UK&#39;s GDP over the past five years.</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">To proceed, we might need to look for an official statistical release or a comprehensive economic report that includes the GDP figures for 2022 and 2023. If such data can be obtained, we can then use it to create the desired line graph. Without this data, we cannot fulfill the request as specified.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;chart_generator&#39;</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;"># 记得提供不同角色的名字</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;role&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;assistant&#39;</span><span style="color:#24292E;">}]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li></li></ol><h2 id="langchain-tool-call-方式" tabindex="-1"><a class="header-anchor" href="#langchain-tool-call-方式" aria-hidden="true">#</a> langchain tool call 方式</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> langchain_core.pydantic_v1 </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> BaseModel, Field</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> typing </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Literal</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> langchain_core.tools </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> tool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">@tool</span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(num1: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">, num2: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;123213</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">    Args:</span></span>
<span class="line"><span style="color:#032F62;">        num1 (str): this is a description</span></span>
<span class="line"><span style="color:#032F62;">        num2 (str): _description_</span></span>
<span class="line"><span style="color:#032F62;">    Return:</span></span>
<span class="line"><span style="color:#032F62;">        None</span></span>
<span class="line"><span style="color:#032F62;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#6F42C1;">@tool</span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test2</span><span style="color:#24292E;">(num1: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;First factor&quot;</span><span style="color:#24292E;">), num2: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;First factor&quot;</span><span style="color:#24292E;">)):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;_summary_</span></span>
<span class="line"><span style="color:#032F62;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test3</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">BaseModel</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;Return product of &#39;x&#39; and &#39;y&#39;.&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    x: </span><span style="color:#005CC5;">float</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;First factor&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    y: </span><span style="color:#005CC5;">float</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Second factor&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> langchain_core.utils.function_calling </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">    convert_to_openai_tool,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">tools </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [test, test2, test3]</span></span>
<span class="line"><span style="color:#24292E;">formatted_tools </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [convert_to_openai_tool(tool) </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> tool </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> tools]</span></span>
<span class="line"><span style="color:#24292E;">formatted_tools</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">[{</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;test&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;123213</span><span style="color:#005CC5;">\n\n</span><span style="color:#032F62;">    Args:</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">        num1 (str): this is a description</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">        num2 (str): _description_</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">    Return:</span><span style="color:#005CC5;">\n</span><span style="color:#032F62;">        None&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;parameters&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;object&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;properties&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;num1&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">}, </span><span style="color:#032F62;">&#39;num2&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">}},</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;required&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;num1&#39;</span><span style="color:#24292E;">]}}},</span></span>
<span class="line"><span style="color:#24292E;"> {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;test2&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;_summary_&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;parameters&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;object&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;properties&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;num1&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;First factor&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#032F62;">&#39;num2&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;First factor&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;string&#39;</span><span style="color:#24292E;">}},</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;required&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;num1&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;num2&#39;</span><span style="color:#24292E;">]}}},</span></span>
<span class="line"><span style="color:#24292E;"> {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;test3&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Return product of &#39;x&#39; and &#39;y&#39;.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;parameters&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;object&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;properties&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;x&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;First factor&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;number&#39;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#032F62;">&#39;y&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;description&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;Second factor&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;number&#39;</span><span style="color:#24292E;">}},</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;required&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;x&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;y&#39;</span><span style="color:#24292E;">]}}}]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 417333277@qq.com">kevinng77</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer"><a href="https://beian.miit.gov.cn/" target="_blank">沪ICP备2023027904号-1</a>&nbsp;<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=" target="_blank"><img src="/assets/gongan.png">公安备案号 </a></div><div class="vp-copyright">Copyright © 2024 吴嘉文 Kevin</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-e8d04472.js" defer></script>
  </body>
</html>
