<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="http://antarina.tech/posts/notes/articles/%E7%AC%94%E8%AE%B0autogen.html"><meta property="og:site_name" content="è®°å¿†ç¬”ä¹¦"><meta property="og:title" content="AUTOGEN | ä¸Šæ‰‹ä¸æºç åˆ†æ"><meta property="og:description" content="AUTOGEN æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå’Œç®¡ç†è‡ªåŠ¨åŒ–å¯¹è¯ä»£ç†ï¼ˆagentsï¼‰ã€‚è¿™äº›ä»£ç†å¯ä»¥å®Œæˆå¤šç§ä»»åŠ¡ï¼Œæ¯”å¦‚å›ç­”é—®é¢˜ã€æ‰§è¡Œå‡½æ•°ï¼Œç”šè‡³ä¸å…¶ä»–ä»£ç†è¿›è¡Œäº¤äº’ã€‚ æœ¬æ–‡æ—¨åœ¨ä»‹ç» Autogen ä¸­çš„å…³é”®ç»„ä»¶ Conversation Agentï¼Œå¹¶å¯¹å…¶ä¸­çš„ Multi-Agent åŠŸèƒ½å®ç°åšç®€å•çš„æºç åˆ†æã€‚ å‚è€ƒå®˜ç½‘æ–‡æ¡£ï¼Œå‚è€ƒä»£ç  Autogen æºç 5a5c0f2 ã€‚"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-05T03:34:03.000Z"><meta property="article:author" content="Kevin å´å˜‰æ–‡"><meta property="article:tag" content="NLP"><meta property="article:tag" content="AIGC"><meta property="article:tag" content="LLM"><meta property="article:tag" content="Agent"><meta property="article:published_time" content="2024-05-25T00:00:00.000Z"><meta property="article:modified_time" content="2024-07-05T03:34:03.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"AUTOGEN | ä¸Šæ‰‹ä¸æºç åˆ†æ","image":[""],"datePublished":"2024-05-25T00:00:00.000Z","dateModified":"2024-07-05T03:34:03.000Z","author":[{"@type":"Person","name":"Kevin å´å˜‰æ–‡"}]}</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet"><link rel="icon" href="/logo.svg"><title>AUTOGEN | ä¸Šæ‰‹ä¸æºç åˆ†æ | è®°å¿†ç¬”ä¹¦</title><meta name="description" content="AUTOGEN æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå’Œç®¡ç†è‡ªåŠ¨åŒ–å¯¹è¯ä»£ç†ï¼ˆagentsï¼‰ã€‚è¿™äº›ä»£ç†å¯ä»¥å®Œæˆå¤šç§ä»»åŠ¡ï¼Œæ¯”å¦‚å›ç­”é—®é¢˜ã€æ‰§è¡Œå‡½æ•°ï¼Œç”šè‡³ä¸å…¶ä»–ä»£ç†è¿›è¡Œäº¤äº’ã€‚ æœ¬æ–‡æ—¨åœ¨ä»‹ç» Autogen ä¸­çš„å…³é”®ç»„ä»¶ Conversation Agentï¼Œå¹¶å¯¹å…¶ä¸­çš„ Multi-Agent åŠŸèƒ½å®ç°åšç®€å•çš„æºç åˆ†æã€‚ å‚è€ƒå®˜ç½‘æ–‡æ¡£ï¼Œå‚è€ƒä»£ç  Autogen æºç 5a5c0f2 ã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-99575b2e.css" as="style"><link rel="stylesheet" href="/assets/style-99575b2e.css">
    <link rel="modulepreload" href="/assets/app-37c77bc0.js"><link rel="modulepreload" href="/assets/ç¬”è®°autogen.html-bff03ee7.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/ç¬”è®°autogen.html-a0730e6c.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><!----><!----><span class="vp-site-name">è®°å¿†ç¬”ä¹¦</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä¸»é¡µ" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="å½’æ¡£" class="vp-link nav-link nav-link" href="/timeline/"><span class="font-icon icon iconfont icon-categoryselected" style=""></span>å½’æ¡£<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/kevinng77" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->AUTOGEN | ä¸Šæ‰‹ä¸æºç åˆ†æ</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Kevin å´å˜‰æ–‡</span></span><span property="author" content="Kevin å´å˜‰æ–‡"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-25T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 10 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT10M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category7 clickable" role="navigation">çŸ¥è¯†ç¬”è®°</span><!--]--><meta property="articleSection" content="çŸ¥è¯†ç¬”è®°"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag8 clickable" role="navigation">NLP</span><span class="page-tag-item tag4 clickable" role="navigation">AIGC</span><span class="page-tag-item tag6 clickable" role="navigation">LLM</span><span class="page-tag-item tag6 clickable" role="navigation">Agent</span><!--]--><meta property="keywords" content="NLP,AIGC,LLM,Agent"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_1-autogen-agent-å®ç°">1. Autogen Agent å®ç°</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#abilities-prior-knowledge">Abilities &amp; Prior Knowledge</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#action-stimuli">Action &amp; Stimuli</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#goals-preference">Goals/Preference</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#past-experience">Past Experience</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_2-autogen-éƒ¨åˆ†ç»†èŠ‚">2. Autogen éƒ¨åˆ†ç»†èŠ‚</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-1-conversable-agent">2.1 Conversable Agent</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-2-multi-agent">2.2 Multi-Agent</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_3-å…¶ä»–">3. å…¶ä»–</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_4-æ€»ç»“">4. æ€»ç»“</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p>AUTOGEN æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå’Œç®¡ç†è‡ªåŠ¨åŒ–å¯¹è¯ä»£ç†ï¼ˆagentsï¼‰ã€‚è¿™äº›ä»£ç†å¯ä»¥å®Œæˆå¤šç§ä»»åŠ¡ï¼Œæ¯”å¦‚å›ç­”é—®é¢˜ã€æ‰§è¡Œå‡½æ•°ï¼Œç”šè‡³ä¸å…¶ä»–ä»£ç†è¿›è¡Œäº¤äº’ã€‚</p><p>æœ¬æ–‡æ—¨åœ¨ä»‹ç» Autogen ä¸­çš„å…³é”®ç»„ä»¶ Conversation Agentï¼Œå¹¶å¯¹å…¶ä¸­çš„ Multi-Agent åŠŸèƒ½å®ç°åšç®€å•çš„æºç åˆ†æã€‚</p><p>å‚è€ƒå®˜ç½‘<a href="https://microsoft.github.io/autogen/docs/tutorial/introduction/" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå‚è€ƒä»£ç  Autogen æºç <a href="https://github.com/microsoft/autogen/commit/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e" target="_blank" rel="noopener noreferrer">5a5c0f2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ã€‚</p><h2 id="_1-autogen-agent-å®ç°" tabindex="-1"><a class="header-anchor" href="#_1-autogen-agent-å®ç°" aria-hidden="true">#</a> 1. Autogen Agent å®ç°</h2><figure><img src="/assets/img/autogen/image-20240525181456648.png" alt="æ¥æºï¼šArtificial Intelligence Foundations of computational agents" tabindex="0" loading="lazy"><figcaption>æ¥æºï¼šArtificial Intelligence Foundations of computational agents</figcaption></figure><p>Autogen ä¸­ agent çš„è®¾è®¡æ€è·¯å¤§è‡´ä¸ºï¼š</p><h3 id="abilities-prior-knowledge" tabindex="-1"><a class="header-anchor" href="#abilities-prior-knowledge" aria-hidden="true">#</a> Abilities &amp; Prior Knowledge</h3><ul><li>é€»è¾‘æ€è€ƒèƒ½åŠ›ï¼š</li></ul><p>å’Œå¤§å¤šæ•°æ™ºèƒ½ä½“è®¾è®¡ä¸€æ ·ï¼ŒAutogen ä½¿ç”¨äº†è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä½œä¸ºé€»è¾‘å•å…ƒã€‚å®ƒé€šè¿‡è°ƒç”¨ OpenAI çš„ Python SDK æ¥è®¿é—® LLM æœåŠ¡ã€‚å› æ­¤ï¼Œä»»ä½•éƒ¨ç½²äº† OpenAI Compatible API çš„ LLM éƒ½å¯ä»¥æ— ç¼å¯¹æ¥åˆ° Autogenã€‚</p><ul><li>å·¥å…·é€‰æ‹©çš„èƒ½åŠ›</li></ul><p>Autogen åˆ©ç”¨äº† <a href="https://platform.openai.com/docs/api-reference/chat/create" target="_blank" rel="noopener noreferrer">openai æä¾›çš„ Toolï¼ˆFunctionsï¼‰åŠŸèƒ½<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ¥è°ƒç”¨å‡½æ•°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è‡ªå®šä¹‰æç¤ºæ¥å¼•å¯¼é€»è¾‘æ¨¡å‹é€‰æ‹©å·¥å…·ã€‚è°ƒç”¨ Openai æœåŠ¡æ—¶ï¼Œåœ¨è¯·æ±‚ä½“çš„ <code>tools</code> ä¸­æä¾›å€™é€‰å‡½æ•°çš„ä¿¡æ¯ï¼ŒOpenai API å°±ä¼šä»ä¸­é€‰å‡ºæœ€å¯èƒ½å®ç°ç”¨æˆ·è¯‰æ±‚çš„å‡½æ•°ã€‚</p><details class="hint-container details"><summary>æŸ¥çœ‹ç¤ºä¾‹ openai è°ƒç”¨ tools è¯·æ±‚</summary><p><strong>ç¤ºä¾‹è¯·æ±‚</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">curl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://api.openai.com/v1/chat/completions</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-H </span><span style="color:#032F62;">&quot;Content-Type: application/json&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-H </span><span style="color:#032F62;">&quot;Authorization: Bearer </span><span style="color:#24292E;">$OPENAI_API_KEY</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#24292E;">-d </span><span style="color:#032F62;">&#39;{</span></span>
<span class="line"><span style="color:#032F62;">  &quot;model&quot;: &quot;gpt-4-turbo&quot;,</span></span>
<span class="line"><span style="color:#032F62;">  &quot;messages&quot;: [</span></span>
<span class="line"><span style="color:#032F62;">    {</span></span>
<span class="line"><span style="color:#032F62;">      &quot;role&quot;: &quot;user&quot;,</span></span>
<span class="line"><span style="color:#032F62;">      &quot;content&quot;: &quot;What&#39;</span><span style="color:#005CC5;">\&#39;</span><span style="color:#032F62;">&#39;s the weather like in Boston today?&quot;</span></span>
<span class="line"><span style="color:#032F62;">    }</span></span>
<span class="line"><span style="color:#032F62;">  ],</span></span>
<span class="line"><span style="color:#032F62;">  &quot;tools&quot;: [</span></span>
<span class="line"><span style="color:#032F62;">    {</span></span>
<span class="line"><span style="color:#032F62;">      &quot;type&quot;: &quot;function&quot;,</span></span>
<span class="line"><span style="color:#032F62;">      &quot;function&quot;: {</span></span>
<span class="line"><span style="color:#032F62;">        &quot;name&quot;: &quot;get_current_weather&quot;,</span></span>
<span class="line"><span style="color:#032F62;">        &quot;description&quot;: &quot;Get the current weather in a given location&quot;,</span></span>
<span class="line"><span style="color:#032F62;">        &quot;parameters&quot;: {</span></span>
<span class="line"><span style="color:#032F62;">          &quot;type&quot;: &quot;object&quot;,</span></span>
<span class="line"><span style="color:#032F62;">          &quot;properties&quot;: {</span></span>
<span class="line"><span style="color:#032F62;">            &quot;location&quot;: {</span></span>
<span class="line"><span style="color:#032F62;">              &quot;type&quot;: &quot;string&quot;,</span></span>
<span class="line"><span style="color:#032F62;">              &quot;description&quot;: &quot;The city and state, e.g. San Francisco, CA&quot;</span></span>
<span class="line"><span style="color:#032F62;">            },</span></span>
<span class="line"><span style="color:#032F62;">            &quot;unit&quot;: {</span></span>
<span class="line"><span style="color:#032F62;">              &quot;type&quot;: &quot;string&quot;,</span></span>
<span class="line"><span style="color:#032F62;">              &quot;enum&quot;: [&quot;celsius&quot;, &quot;fahrenheit&quot;]</span></span>
<span class="line"><span style="color:#032F62;">            }</span></span>
<span class="line"><span style="color:#032F62;">          },</span></span>
<span class="line"><span style="color:#032F62;">          &quot;required&quot;: [&quot;location&quot;]</span></span>
<span class="line"><span style="color:#032F62;">        }</span></span>
<span class="line"><span style="color:#032F62;">      }</span></span>
<span class="line"><span style="color:#032F62;">    }</span></span>
<span class="line"><span style="color:#032F62;">  ],</span></span>
<span class="line"><span style="color:#032F62;">  &quot;tool_choice&quot;: &quot;auto&quot;</span></span>
<span class="line"><span style="color:#032F62;">}&#39;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹å›å¤</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;chatcmpl-abc123&quot;,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;object&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;chat.completion&quot;,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;created&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1699896916</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;model&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;gpt-3.5-turbo-0125&quot;,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;choices&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">&quot;index&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">&quot;message&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;role&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;assistant&quot;,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;content&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">null,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;tool_calls&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">          {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;call_abc123&quot;,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;function&quot;,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;function&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#6F42C1;">&quot;name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;get_current_weather&quot;,</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#6F42C1;">&quot;arguments&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;{\n</span><span style="color:#005CC5;">\&quot;</span><span style="color:#032F62;">location</span><span style="color:#005CC5;">\&quot;</span><span style="color:#032F62;">: </span><span style="color:#005CC5;">\&quot;</span><span style="color:#032F62;">Boston, MA</span><span style="color:#005CC5;">\&quot;</span><span style="color:#032F62;">\n}&quot;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#24292E;">        ]</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">&quot;logprobs&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">null,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">&quot;finish_reason&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;tool_calls&quot;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  ],</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">&quot;usage&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;prompt_tokens&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">82</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;completion_tokens&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">17</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;total_tokens&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">99</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><ul><li>é€šä¿¡åŠŸèƒ½</li></ul><p>æ¯ä¸ª agent éƒ½å¯ä»¥ä½¿ç”¨è‡ªå¸¦çš„ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L611" target="_blank" rel="noopener noreferrer">send<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å’Œ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L785C9-L785C16" target="_blank" rel="noopener noreferrer">receive<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ–¹æ³•å’Œå…¶ä»– agent è¿›è¡Œé€šä¿¡ã€‚</p><h3 id="action-stimuli" tabindex="-1"><a class="header-anchor" href="#action-stimuli" aria-hidden="true">#</a> Action &amp; Stimuli</h3><p>æ™ºèƒ½ä½“åœ¨é€‰æ‹©äº†åˆé€‚çš„å·¥å…·åï¼Œå¯ä»¥æ‰§è¡Œè¯¥å·¥å…·å¹¶æ¥æ”¶å·¥å…·è¿”å›çš„ç»“æœã€‚</p><h3 id="goals-preference" tabindex="-1"><a class="header-anchor" href="#goals-preference" aria-hidden="true">#</a> Goals/Preference</h3><p>Autogen é€šè¿‡ä¸ºä¸åŒçš„æ™ºèƒ½ä½“æä¾›ä¸åŒçš„ç³»ç»Ÿæç¤ºè¯æ¥å®ç°ä¸ªæ€§åŒ–è®¾ç½®ã€‚</p><h3 id="past-experience" tabindex="-1"><a class="header-anchor" href="#past-experience" aria-hidden="true">#</a> Past Experience</h3><p>æ¯ä¸ªæ™ºèƒ½ä½“éƒ½ä¼šç»´æŠ¤è‡ªå·±çš„å†å²è®°å½•ï¼Œä»¥ List[Message] çš„å½¢å¼ä¿å­˜ï¼Œå…¶ä¸­ Message åŒ…æ‹¬äº†å†å²å¯¹è¯ä¿¡æ¯å’Œæ‰§è¡Œå‡½æ•°çš„ç»“æœç­‰</p><h2 id="_2-autogen-éƒ¨åˆ†ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#_2-autogen-éƒ¨åˆ†ç»†èŠ‚" aria-hidden="true">#</a> 2. Autogen éƒ¨åˆ†ç»†èŠ‚</h2><h3 id="_2-1-conversable-agent" tabindex="-1"><a class="header-anchor" href="#_2-1-conversable-agent" aria-hidden="true">#</a> 2.1 Conversable Agent</h3><p><a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L46" target="_blank" rel="noopener noreferrer">Conversable Agent<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ˜¯ Autogen ä¸­çš„åŸºæœ¬æ™ºèƒ½ä½“ç±»å‹ï¼Œå…¶ä»–å¦‚ AssistantAgent æˆ– UserProxyAgent éƒ½æ˜¯åŸºäºæ­¤ç±»å®ç°çš„ã€‚</p><h4 id="_2-1-1-ä¸º-conversable-agent-é…ç½®-llm" tabindex="-1"><a class="header-anchor" href="#_2-1-1-ä¸º-conversable-agent-é…ç½®-llm" aria-hidden="true">#</a> 2.1.1 ä¸º Conversable Agent é…ç½® LLM</h4><p>åˆå§‹åŒ– <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L46" target="_blank" rel="noopener noreferrer">Conversable Agent<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ—¶æä¾›çš„ <code>config_list</code>ï¼Œéƒ½ä¼šè¢«ç”¨æ¥åˆå§‹åŒ– openai <code>OpenAI</code> å¯¹è±¡ã€‚å¦‚é€šè¿‡ä»¥ä¸‹æ–¹æ³•åˆ›å»º conversable Agent å®ä¾‹å</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> autogen </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> ConversableAgent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">config_list </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;api_type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;azure&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;model&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">AZURE_OPENAI_CHAT_DEPLOYMENT_NAME</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;api_key&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">AZURE_OPENAI_API_KEY</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;http_client&quot;</span><span style="color:#24292E;">: xxxxx,  </span><span style="color:#6A737D;"># ç¡®ä¿ä¼ å…¥çš„æ˜¯å¯ä»¥è¿›è¡Œ deepcopy çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;base_url&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">AZURE_OPENAI_ENDPOINT</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">agent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConversableAgent(</span><span style="color:#032F62;">&quot;chatbot&quot;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">llm_config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#032F62;">&quot;config_list&quot;</span><span style="color:#24292E;">: config_list})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼ŒConversable Agent ä¼šä½¿ç”¨ç±»ä¼¼ä»¥ä¸‹çš„æ–¹å¼åˆ›å»º OpenAI å®ä¾‹ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> AzureOpenAI(</span><span style="color:#D73A49;">**</span><span style="color:#24292E;">config_list)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä»¥ä¸Šä¸ºä¼ªä»£ç ï¼Œå…·ä½“å®ç°å‚è€ƒ<a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/oai/client.py#L410" target="_blank" rel="noopener noreferrer">æºç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><h4 id="_2-1-2-generate-reply" tabindex="-1"><a class="header-anchor" href="#_2-1-2-generate-reply" aria-hidden="true">#</a> 2.1.2 Generate Reply</h4><p><a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1918" target="_blank" rel="noopener noreferrer">generate_reply<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ˜¯ Conversable Agent çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚æ­¤å‡½æ•°ä¼šæ ¹æ®æ¥æ”¶åˆ°çš„æ¶ˆæ¯å’Œé…ç½®ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ³¨å†Œçš„å¤„ç†å‡½æ•°å’Œå›å¤ç”Ÿæˆå‡½æ•°ï¼Œæ¥äº§ç”Ÿä¸€ä¸ªå›å¤ã€‚ä¾‹å¦‚ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> agent.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;ä½ å¥½&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">}])</span></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(reply) </span><span style="color:#6A737D;"># ä½ å¥½ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„ï¼Ÿ</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤è¿‡ç¨‹åŒ…æ‹¬æ¶ˆæ¯çš„é¢„å¤„ç†ã€å†å²æ¶ˆæ¯çš„æ•´ç†å’Œå›å¤çš„ç”Ÿæˆç­‰æ­¥éª¤ï¼Œå…è®¸é€šè¿‡å®šåˆ¶åŒ–çš„é’©å­ï¼ˆhookï¼‰æ¥å¤„ç†ç‰¹å®šçš„é€»è¾‘ã€‚ä¸ºäº†è€ƒè™‘åˆ° agent è°ƒç”¨å·¥å…·ï¼Œå¯¹è¯ï¼Œå‚è€ƒå†å²ç»éªŒç­‰åŠŸèƒ½ï¼Œ<code>generate_reply</code> çš„å¤§è‡´è¿è¡Œæ€è·¯å¦‚ä¸‹ï¼š</p><ul><li><strong>æ­¥éª¤ä¸€ï¼šå¤„ç†æœ€åæ¥æ”¶çš„æ¶ˆæ¯ï¼ˆprocess_last_received_messageï¼‰</strong></li></ul><p>æ­¤åŠŸèƒ½é€šè¿‡æ³¨å†Œçš„é’©å­ï¼ˆhookï¼‰ä½¿ç”¨å¹¶å¯èƒ½ä¿®æ”¹æœ€åä¸€æ¡æ¶ˆæ¯çš„æ–‡æœ¬:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">messages </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.process_last_received_message(messages)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ‘ä»¬åªéœ€è¦å† <code>self.hook_lists[&#39;process_last_received_message&#39;]</code> ä¸­æ·»åŠ å¯¹åº”çš„å‡½æ•°ï¼Œå°±èƒ½è‡ªå®šä¹‰å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># process_last_received_message ä¼ªä»£ç </span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">process_last_received_message</span><span style="color:#24292E;">(messages):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> hook </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.hook_lists[</span><span style="color:#032F62;">&#39;process_last_received_message&#39;</span><span style="color:#24292E;">]:</span></span>
<span class="line"><span style="color:#24292E;">    messages[</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hook(messages[</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> messages</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…·ä½“å‚è€ƒ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1961" target="_blank" rel="noopener noreferrer">process_last_received_message<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ã€‚</p><ul><li><strong>æ­¥éª¤äºŒï¼šå¤„ç†å›å¤å‰çš„æ‰€æœ‰æ¶ˆæ¯ï¼ˆprocess_all_messages_before_replyï¼‰</strong></li></ul><p>è¿™ä¸€æ­¥éª¤ä¸å¤„ç†æœ€åæ¥æ”¶çš„æ¶ˆæ¯ç›¸ä¼¼ï¼Œä½¿ç”¨ç›¸åŒçš„é€»è¾‘ã€‚æˆ‘ä»¬åªéœ€è¦å† <code>self.hook_lists[&#39;process_all_messages_before_reply&#39;]</code> ä¸­æ·»åŠ å¯¹åº”çš„å‡½æ•°ï¼Œå°±èƒ½è‡ªå®šä¹‰å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•ã€‚</p><p>å› ä¸º LLM ä¸Šä¸‹æ–‡é•¿åº¦æœ‰é™ï¼Œå› æ­¤é€šå¸¸è¿™æ­¥å¯ä»¥ç”¨æ¥å¯¹å†å²ä¿¡æ¯è¿›è¡Œæ•´ç†ï¼Œç­›é€‰ç­‰ç­‰ã€‚</p><p>å…·ä½“å‚è€ƒ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1965" target="_blank" rel="noopener noreferrer">process_all_messages_before_reply<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li><strong>æ­¥éª¤ä¸‰ï¼šç”Ÿæˆå›å¤ï¼ˆgenerate_replyï¼‰</strong></li></ul><p>Autogen æŠŠå¤šç§ä¸åŒåŠŸèƒ½çš„ agent éƒ½æ•´åˆåˆ°äº† Conversable Agent å½“ä¸­ï¼Œagent ç”Ÿæˆå›å¤æ—¶çš„é€»è¾‘å¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># ä¼ªä»£ç    </span></span>
<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> reply_func_tuple </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">._reply_func_list:</span></span>
<span class="line"><span style="color:#24292E;">    final, reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> reply_func(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">messages, </span><span style="color:#E36209;">sender</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">sender, </span><span style="color:#E36209;">config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">reply_func_tuple[</span><span style="color:#032F62;">&quot;config&quot;</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> final:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> reply</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>self._reply_func_list</code> ä¸­åŒ…å«ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#005CC5;">self</span><span style="color:#24292E;">._reply_func_list </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [ConversableAgent.check_termination_and_human_reply,</span></span>
<span class="line"><span style="color:#24292E;">ConversableAgent.generate_function_call_reply,</span></span>
<span class="line"><span style="color:#24292E;">ConversableAgent.generate_tool_calls_reply,</span></span>
<span class="line"><span style="color:#24292E;">ConversableAgent.generate_oai_reply]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1692" target="_blank" rel="noopener noreferrer">check_termination_and_human_reply<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>é€šè¿‡ messages æ¥åˆ¤æ–­ç°åœ¨æ—¶å€™éœ€è¦ç»ˆæ­¢ agent å¯¹è¯ï¼Œæˆ–è€…éœ€è¦è®¤ä¸ºæ¥å…¥ã€‚</p><p>ä¾‹å¦‚ï¼šå½“æœ€åä¸€ä¸ªæ¶ˆæ¯ä¸­åŒ…å«äº†ç‰¹å®šçš„ç»ˆæ­¢å­—ç¬¦ï¼›æˆ–å¯¹è¯è½®æ•°è¾¾åˆ°äº†ä¸Šé™ç­‰ç­‰ã€‚ç»ˆæ­¢å­—ç¬¦å’Œå¯¹è¯ä¸Šé™éƒ½å¯ä»¥è‡ªå®šä¹‰ã€‚</p><ul><li>generate_function_call_reply</li></ul><p>å¯ä»¥å¿½ç•¥è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºä»–è¢« <code>generate_tool_calls_reply</code> å–ä»£äº†ï¼ŒåŸºæœ¬ä¸Šç”¨ä¸åˆ°</p><ul><li><a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1600" target="_blank" rel="noopener noreferrer">generate_tool_calls_reply<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>è¯¥å‡½æ•°ç»™å·¥å…·å‹çš„ agent æ‰§è¡Œï¼Œllm å‹çš„ agent é»˜è®¤ä¸è§¦å‘ã€‚</p><p>ä¾‹å¦‚å‚è€ƒ <a href="https://microsoft.github.io/autogen/docs/tutorial/tool-use" target="_blank" rel="noopener noreferrer">autogen å®˜æ–¹çš„ Tool ä½¿ç”¨ç¤ºä¾‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> é…ç½®åï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> typing </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Annotated, Literal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Operator </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Literal[</span><span style="color:#032F62;">&quot;+&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;*&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">calculator</span><span style="color:#24292E;">(a: </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">, b: </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">, operator: Annotated[Operator, </span><span style="color:#032F62;">&quot;operator&quot;</span><span style="color:#24292E;">]) -&gt; </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> operator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;+&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> a </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> b</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">elif</span><span style="color:#24292E;"> operator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;-&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> a </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> b</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">elif</span><span style="color:#24292E;"> operator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;*&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> a </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> b</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">elif</span><span style="color:#24292E;"> operator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">(a </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> b)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">raise</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ValueError</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Invalid operator&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">user_proxy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConversableAgent(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;User&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">llm_config</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">human_input_mode</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;NEVER&quot;</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">user_proxy.register_for_execution(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;calculator&quot;</span><span style="color:#24292E;">)(calculator)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> user_proxy.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span><span style="color:#032F62;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;tool_calls&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;123&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;function&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;calculator&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;arguments&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;{&quot;a&quot;: 232, &quot;b&quot;: 40, &quot;operator&quot;: &quot;-&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">]}])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">reply == {&#39;role&#39;: &#39;tool&#39;,</span></span>
<span class="line"><span style="color:#032F62;"> &#39;tool_responses&#39;: [{&#39;tool_call_id&#39;: &#39;123&#39;, &#39;role&#39;: &#39;tool&#39;, &#39;content&#39;: &#39;192&#39;}],</span></span>
<span class="line"><span style="color:#032F62;"> &#39;content&#39;: &#39;192&#39;}</span></span>
<span class="line"><span style="color:#032F62;"> &quot;&quot;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>user_proxy</code> è°ƒç”¨ <code>generate_reply</code> æ—¶å°±ä¼šæ‰§è¡Œ<code>generate_tool_calls_reply</code> ã€‚å¤§è‡´æ€è·¯å°±æ˜¯æŠŠè¾“å…¥çš„ <code>tool_calls</code> çš„å‚æ•°ï¼Œä¼ é€’ç»™å¯¹åº”çš„å‡½æ•°æ‰§è¡Œï¼Œç„¶åè¿”å›å‡½æ•°æ‰§è¡Œçš„ç»“æœã€‚</p><ul><li><a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1328" target="_blank" rel="noopener noreferrer">generate_oai_reply<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>è°ƒç”¨ LLM æœåŠ¡ï¼Œæ ¹æ®å½“å‰çš„ messages æ¥ç”Ÿæˆå›å¤ã€‚è¯¥å‡½æ•°åˆ†ä¸º 2 ç§æƒ…å†µï¼Œå…³è”äº†å‡½æ•°ï¼Œå’Œä¸å…³è”å‡½æ•°ï¼š</p><p><strong>ä¸å…³è”å‡½æ•°ï¼š</strong></p><p>é»˜è®¤æƒ…å†µä¸‹ Conversable Agent æ˜¯ä¸å…³è”å‡½æ•°çš„ã€‚å¦‚ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> autogen </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> ConversableAgent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">agent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConversableAgent(</span><span style="color:#032F62;">&quot;chatbot&quot;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">llm_config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#032F62;">&quot;config_list&quot;</span><span style="color:#24292E;">: config_list})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ²¡æœ‰æ³¨å†Œ tool æ—¶å€™ï¼Œä½¿ç”¨ generate_reply</span></span>
<span class="line"><span style="color:#24292E;">reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> agent.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;What is 1+1.&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">}])</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="hint-container details"><summary>æ²¡æœ‰æ³¨å†Œ tool æ—¶å€™å‘ç»™ openai çš„è¯·æ±‚</summary><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">å‘ç»™ openai çš„ payload</span></span>
<span class="line"><span style="color:#032F62;">{&#39;messages&#39;: [{&#39;content&#39;: &quot;You are a helpful AI assistant. You can help with simple calculations. Return &#39;TERMINATE&#39; when the task is done.&quot;, </span></span>
<span class="line"><span style="color:#032F62;">&#39;role&#39;: &#39;system&#39;}, {&#39;content&#39;: &#39;What is 1+1.&#39;, &#39;role&#39;: &#39;user&#39;}], &#39;model&#39;: &#39;gpt-4-128k-0125&#39;}</span></span>
<span class="line"><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>ä¸å…³è”å‡½æ•°æ—¶ï¼Œå°±åƒå’Œ GPT å¯¹è¯ä¸€æ ·å›å¤æ­£å¸¸å†…å®¹ã€‚</p><p><strong>å…³è”å‡½æ•°ï¼š</strong></p><p>ç»™ agent å…³è”å‡½æ•°ä¹‹åï¼Œåœ¨ç”Ÿæˆå›å¤æ—¶ï¼Œä¼šè€ƒè™‘æ˜¯å¦éœ€è¦ä½¿ç”¨å‡½æ•°å·¥å…·ï¼Œå¦‚å‚è€ƒ<a href="https://microsoft.github.io/autogen/docs/tutorial/tool-use" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œä¸º agent æ³¨å†Œå‡½æ•°ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">assistant.register_for_llm(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;calculator&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;A simple calculator&quot;</span><span style="color:#24292E;">)(calculator)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åè°ƒç”¨ <code>generate_reply</code>:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># æœ‰æ³¨å†Œ tool æ—¶å€™ï¼Œä½¿ç”¨ generate_reply</span></span>
<span class="line"><span style="color:#24292E;">reply_2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> assistant.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;What is 1+1.&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">}])</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><details class="hint-container details"><summary>æœ‰æ³¨å†Œ tool æ—¶å€™å‘ç»™ openai çš„è¯·æ±‚</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;messages&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;You are a helpful AI assistant. You can help with simple calculations. Return &quot;</span><span style="color:#B31D28;font-style:italic;">TERMINATE</span><span style="color:#032F62;">&quot; when the task is done.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;system&quot;</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;content&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;What is 1+1.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;tools&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;function&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">&quot;function&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;description&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;A simple calculator&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;calculator&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">&quot;parameters&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;object&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;properties&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#005CC5;">&quot;a&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;integer&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;description&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;a&quot;</span></span>
<span class="line"><span style="color:#24292E;">                        },</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#005CC5;">&quot;b&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;integer&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;description&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;b&quot;</span></span>
<span class="line"><span style="color:#24292E;">                        },</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#005CC5;">&quot;operator&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;enum&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&quot;+&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&quot;-&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&quot;*&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&quot;/&quot;</span></span>
<span class="line"><span style="color:#24292E;">                            ],</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;string&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                            </span><span style="color:#005CC5;">&quot;description&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;operator&quot;</span></span>
<span class="line"><span style="color:#24292E;">                        }</span></span>
<span class="line"><span style="color:#24292E;">                    },</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#005CC5;">&quot;required&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#032F62;">&quot;b&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#032F62;">&quot;operator&quot;</span></span>
<span class="line"><span style="color:#24292E;">                    ]</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;model&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;gpt-4-128k-0125&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>å›å¤ç»“æœæ ¼å¼ä¸ºï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#032F62;">&#39;content&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;role&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;assistant&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;function_call&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;tool_calls&#39;</span><span style="color:#24292E;">: [{</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;call_dBSB0eUcGXqPjmSvLEpbf8t6&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">: {</span><span style="color:#032F62;">&#39;arguments&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;{&quot;a&quot;:1,&quot;b&quot;:1,&quot;operator&quot;:&quot;+&quot;}&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;calculator&#39;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;function&#39;</span><span style="color:#24292E;">}]}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Generate Reply æ€»ç»“</strong></p><p>æ•´ä½“ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generate_reply</span><span style="color:#24292E;">(messages: List[], sender: [Agent] ):</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># å¤„ç†æœ€åæ¥æ”¶çš„æ¶ˆæ¯ï¼Œå¯ä»¥æ’å…¥è‡ªå®šä¹‰ hook</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> hook </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.hook_lists[</span><span style="color:#032F62;">&#39;process_last_received_message&#39;</span><span style="color:#24292E;">]:</span></span>
<span class="line"><span style="color:#24292E;">        messages[</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hook(messages[</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># å¤„ç†æ‰€æœ‰å†å²æ¶ˆæ¯ï¼Œå¯ä»¥æ’å…¥è‡ªå®šä¹‰ hook</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> hook </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.hook_lists[</span><span style="color:#032F62;">&#39;process_all_messages_before_reply&#39;</span><span style="color:#24292E;">]:</span></span>
<span class="line"><span style="color:#24292E;">        messages </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hook(messages)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">._reply_func_list </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># self._reply_func_list å¯ä»¥æ’å…¥è‡ªå®šä¹‰å‡½æ•°</span></span>
<span class="line"><span style="color:#24292E;">        your_customized_function,  </span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># å¦‚æœè¾¾åˆ°äº†ç»ˆæ­¢æ¡ä»¶ï¼Œåˆ™åç»­å‡½æ•°éƒ½ä¸ä¼šæ‰§è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        ConversableAgent.check_termination_and_human_reply,</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># å½“ llm_config=False, å¹¶ä¸”æ³¨å†Œäº†å‡½æ•°æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        ConversableAgent.generate_tool_calls_reply,</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># å½“ llm_config!=False æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        ConversableAgent.generate_oai_reply</span></span>
<span class="line"><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> reply_func_tuple </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">._reply_func_list:</span></span>
<span class="line"><span style="color:#24292E;">        final, reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> reply_func(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">messages, </span><span style="color:#E36209;">sender</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">sender, </span><span style="color:#E36209;">config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">reply_func_tuple[</span><span style="color:#032F62;">&quot;config&quot;</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> final:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> reply</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-3-ä»£ç æ‰§è¡Œå™¨-code-executor" tabindex="-1"><a class="header-anchor" href="#_2-1-3-ä»£ç æ‰§è¡Œå™¨-code-executor" aria-hidden="true">#</a> 2.1.3 <strong>ä»£ç æ‰§è¡Œå™¨ï¼ˆCode Executorï¼‰</strong></h4><p>é€šè¿‡è‡ªå®šä¹‰çš„æœ¬åœ°å‘½ä»¤è¡Œä»£ç æ‰§è¡Œå™¨ï¼Œä»£ç†å¯ä»¥å®‰å…¨åœ°æ‰§è¡Œ GPT ç”Ÿæˆçš„ä»£ç ã€‚AutoGPT è‡ªå¸¦ dockerï¼Œ jupter å’Œ local ä¸‰ç§ä»£ç æ‰§è¡Œå™¨ã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> tempfile</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> autogen </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> ConversableAgent</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> autogen.coding </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> LocalCommandLineCodeExecutor</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">temp_dir </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> tempfile.TemporaryDirectory()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">executor </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LocalCommandLineCodeExecutor(</span><span style="color:#E36209;">timeout</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#E36209;">work_dir</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">temp_dir.name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">code_executor_agent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConversableAgent(</span><span style="color:#032F62;">&quot;code_executor_agent&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">code_execution_config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#032F62;">&quot;executor&quot;</span><span style="color:#24292E;">: executor})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">message_with_code_block </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;&quot;This is a message with code block.</span></span>
<span class="line"><span style="color:#032F62;">The code block is below:</span></span>
<span class="line"><span style="color:#032F62;">```</span></span>
<span class="line"><span style="color:#032F62;">print(1+asdf)</span></span>
<span class="line"><span style="color:#032F62;">```</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">```</span></span>
<span class="line"><span style="color:#032F62;">print(&quot;second&quot;)</span></span>
<span class="line"><span style="color:#032F62;">```</span></span>
<span class="line"><span style="color:#032F62;">This is the end of the message.</span></span>
<span class="line"><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Generate a reply for the given code.</span></span>
<span class="line"><span style="color:#24292E;">reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> code_executor_agent.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span><span style="color:#032F62;">&quot;role&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;user&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;content&quot;</span><span style="color:#24292E;">: message_with_code_block}])</span></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(reply)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç æ‰§è¡Œå™¨çš„æ€è·¯ä¸º</p><ol><li>é¦–å…ˆåœ¨ <code>self._reply_func_list</code> æ’å…¥ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L1409" target="_blank" rel="noopener noreferrer">_generate_code_execution_reply_using_executor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å‡½æ•°ã€‚</li><li>ä»¥ä¸Šå‡½æ•°ä¼šå…ˆä½¿ç”¨ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/coding/local_commandline_code_executor.py#L180" target="_blank" rel="noopener noreferrer">markdown è§£æå™¨<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ¥ä»è¾“å…¥çš„ message ç§æå–ä»£ç ã€‚</li><li>è€Œåä½¿ç”¨<a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/coding/local_commandline_code_executor.py#L236" target="_blank" rel="noopener noreferrer">æ‰§è¡Œå™¨<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ¥æ‰§è¡ŒæŠ½å–å‡ºæ¥çš„ä»£ç ã€‚</li></ol><p>å¦‚æœéœ€è¦è‡ªå®šä¹‰ä»£ç è§£æå’Œæ‰§è¡Œæ–¹å¼çš„è¯ï¼Œåªéœ€è¦å‚è€ƒ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/coding/local_commandline_code_executor.py#L32" target="_blank" rel="noopener noreferrer">LocalCommandLineCodeExecutor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> é›†æˆ CodeExecutor å¹¶é‡å†™ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/coding/local_commandline_code_executor.py#L180C9-L180C23" target="_blank" rel="noopener noreferrer">code_extractor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å’Œ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/coding/local_commandline_code_executor.py#L236C9-L236C28" target="_blank" rel="noopener noreferrer">execute_code_blocks<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ã€‚</p><h4 id="_2-1-4-init-chat" tabindex="-1"><a class="header-anchor" href="#_2-1-4-init-chat" aria-hidden="true">#</a> 2.1.4 Init Chat</h4><p>é€šè¿‡ä¸Šæ–‡å¯ä»¥çœ‹åˆ° Autogen å¯¹ ConversableAgent çš„åŒ…è£…ï¼Œå¹¶ä¸ç¬¦åˆ Agent çš„å®šä¹‰ï¼š</p><ul><li>å½“ ConversableAgent è®¾ç½®äº† <code>lm_config=False</code>ï¼Œå¹¶æ³¨å†Œäº†å‡½æ•°åï¼Œæ”¹ Agent ç›¸å½“äºä¸€ä¸ªæŒ‡æŒ¥æ‰§è¡Œå‡½æ•°çš„å·¥å…·ã€‚</li><li>å¦‚æœéœ€è¦è®¾è®¡ä¸€ä¸ªä¼šä½¿ç”¨å‡½æ•°çš„ Agent çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦ç”¨ 2 ä¸ª ConversableAgent æ¥å®ç°ï¼Œå…·ä½“å‚è€ƒ<a href="https://microsoft.github.io/autogen/docs/tutorial/tool-use" target="_blank" rel="noopener noreferrer">å®˜ç½‘æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</li></ul><p>æ‰€æœ‰ ConversableAgent é—´çš„å¯¹è¯éƒ½é€šè¿‡ <code>initiate_chat</code> å‡½æ•°å¯åŠ¨ï¼Œé€šè¿‡ <code>send</code> å’Œ <code>receive</code> å‡½æ•°è¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œç¡®ä¿ä¿¡æ¯æ­£ç¡®æ¥æ”¶ã€‚è€Œè¿™ç§è®¾ç½®ï¼Œæ˜¯çš„å¼€å‘è€…å¯ä»¥ä½¿ç”¨å¤šä¸ª ConversableAgent æ¥çµæ´»æ­é…ï¼Œç»„åˆå‡ºä»–ä»¬æƒ³è¦å¾— Agent ç³»ç»Ÿã€‚å¦‚ï¼š</p><ul><li>å®ç°ä¸€ä¸ªå¯ä»¥ä½¿ç”¨å¤–éƒ¨ python å‡½æ•°çš„åŠ©æ‰‹ã€‚<a href="https://microsoft.github.io/autogen/docs/tutorial/tool-use" target="_blank" rel="noopener noreferrer">link<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>ç”¨å¤šä¸ª ConversableAgent å®ç°èŠå¤©å®¤ã€‚<a href="https://microsoft.github.io/autogen/docs/Use-Cases/agent_chat" target="_blank" rel="noopener noreferrer">link<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>ç”¨å¤šä¸ª ConversableAgent å®ç°å›ºå®šå·¥ä½œæµã€‚<a href="https://microsoft.github.io/autogen/docs/topics/groupchat/customized_speaker_selection" target="_blank" rel="noopener noreferrer">link<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>ç­‰å…¶ä»–ç³»ç»Ÿã€‚</p><p>initiate_chat ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># å®ç°ä¸€ä¸ªå¯ä»¥ä½¿ç”¨å¤–éƒ¨ python å‡½æ•°çš„åŠ©æ‰‹</span></span>
<span class="line"><span style="color:#24292E;">chat_result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> user_proxy.initiate_chat(assistant, </span><span style="color:#E36209;">message</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;What is (44232 + 13312 / (232 - 32)) * 5?&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>initiate_chat å®ç°é€»è¾‘ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># ä¼ªä»£ç </span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">initiate_chat</span><span style="color:#24292E;">(recipient, message, clear_history, </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">args):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># å¯ä»¥é…ç½® clear_history æ¥æ¸…ç©ºå†å²è®°å½•</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">._prepare_chat(recipient, clear_history)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># å¯è®¾ç½® agent æœ€å¤šå¯¹è¯å›åˆæ•°</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> _ </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">range</span><span style="color:#24292E;">(max_turns):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> _ </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;"># å¯¹ message è¿›è¡Œäº†ä¸€äº›ç®€å•çš„æ ¼å¼é¢„å¤„ç†</span></span>
<span class="line"><span style="color:#24292E;">            msg2send </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.generate_init_message(message, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">kwargs)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;"># ä½¿ç”¨ generate_reply ï¼Œæ ¹æ® message ç”Ÿæˆå›å¤</span></span>
<span class="line"><span style="color:#24292E;">            msg2send </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.chat_messages[recipient], </span><span style="color:#E36209;">sender</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">recipient)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> msg2send </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># å‘é€æ¶ˆæ¯ç»™ä¸‹ä¸€ä¸ª Agent</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.send(msg2send, recipient, </span><span style="color:#E36209;">request_reply</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">, </span><span style="color:#E36209;">silent</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">silent)</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    summary </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">._summarize_chat(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    chat_result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ChatResult(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> chat_result</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Š init_chat çš„æ ¸å¿ƒåœ¨äº <code>send</code> å‡½æ•°ï¼š</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># ä¼ªä»£ç </span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(self, message: Union[Dict, </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">], recipient: Agent,</span></span>
<span class="line"><span style="color:#24292E;">        request_reply: Optional[</span><span style="color:#005CC5;">bool</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> recipient.receive(message, </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">, request_reply, silent)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">receive</span><span style="color:#24292E;">(self, message: Union[Dict, </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">], sender: Agent, request_reply: Optional[</span><span style="color:#005CC5;">bool</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,):</span></span>
<span class="line"><span style="color:#24292E;">    reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.generate_reply(</span><span style="color:#E36209;">messages</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.chat_messages[sender], </span><span style="color:#E36209;">sender</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">sender)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> reply </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.send(reply, sender, </span><span style="color:#E36209;">silent</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">silent)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ï¼Œautogen è®¾è®¡çš„ send å’Œ receive å‡½æ•°å½¢æˆäº†ä¸€ä¸ªé—­ç¯ï¼Œåªè¦ <code>generate_reply</code> ä¸å› ä¸º ConversableAgent.check_termination_and_human_reply è¢«ç»ˆæ­¢ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ª Agent å°±ä¼šä¸€ç›´å¯¹è¯ä¸‹å»ã€‚</p><p>å½“ç„¶ï¼Œinitiate chat ä¸­è¿˜æœ‰å¾ˆå¤šæœ‰æ„æ€çš„è®¾è®¡ï¼Œå…·ä½“è¯·å‚è€ƒ <a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/autogen/agentchat/conversable_agent.py#L893" target="_blank" rel="noopener noreferrer">inititate_chat<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æºç ã€‚</p><h3 id="_2-2-multi-agent" tabindex="-1"><a class="header-anchor" href="#_2-2-multi-agent" aria-hidden="true">#</a> 2.2 Multi-Agent</h3><p>é€šè¿‡ä»¥ä¸Š <code>initiate_chat</code> æˆ‘ä»¬å¤§è‡´æ¸…æ¥šäº† 2 ä¸ª Agent æ˜¯æ€ä¹ˆå¯¹è¯çš„ï¼š</p><ul><li>é€šè¿‡ <code>send</code> å’Œ <code>receive</code> å‡½æ•°å®ç°é—­ç¯å¯¹è¯ã€‚</li></ul><p>é‚£å¦‚æœæˆ‘ä»¬æƒ³è¦è®© 2 ä¸ªä»¥ä¸Šçš„ agent è¿›è¡Œå¯¹è¯ï¼Œå¯ä»¥ä½¿ç”¨ Autogen åŒ…è£…å¥½çš„ <a href="https://github.com/microsoft/autogen/blob/main/notebook/agentchat_groupchat.ipynb" target="_blank" rel="noopener noreferrer">GroupChat<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p>GroupChat çš„å®ç°é€»è¾‘å¤§è‡´ä¸ºï¼š</p><ul><li>å»ºç«‹ä¸€ä¸ª GroupManager æ¥æ‰®æ¼”é‚®å·®çš„è§’è‰²ã€‚</li><li>æ‰€æœ‰ Group é‡Œçš„ Agent ä¸ç›´æ¥å¯¹è¯ï¼Œè€Œæ˜¯é€šè¿‡ GroupManager å®ç°å¯¹è¯çš„ä¼ é€’ã€‚</li></ul><p>è¿™ç§ GroupChat çš„è®¾è®¡æ–¹å¼å…è®¸æˆ‘ä»¬è®¾è®¡è‡ªç”±è®¨è®ºçš„ Multi-agentï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å®ç°å›ºå®š flow çš„ Multi-Agent å·¥ä½œæµã€‚</p><p>å…·ä½“å¯ä»¥å‚è€ƒï¼š<a href="https://microsoft.github.io/autogen/docs/topics/groupchat/customized_speaker_selection" target="_blank" rel="noopener noreferrer">link<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_3-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#_3-å…¶ä»–" aria-hidden="true">#</a> 3. å…¶ä»–</h2><p><strong>å¼€æºç¤¾åŒºè´¡çŒ®</strong><br><code>autogen.agentchat.contrib</code> è¿™é‡Œå¯ä»¥æ‰¾åˆ°è®¸å¤šå…³äºè‡ªåŠ¨åŒ–å¯¹è¯ç³»ç»Ÿçš„è´¡çŒ®ã€‚</p><p><strong>Agent ä¼˜åŒ–å™¨</strong></p><p>å®˜æ–¹ notebook ä¸­æœ‰å…³äº Agent ä¼˜åŒ–å™¨çš„è®¨è®ºã€‚<a href="https://github.com/microsoft/autogen/blob/5a5c0f2a11bfc1efe3955fa9f7e2ec38aedef14e/notebook/agentchat_agentoptimizer.ipynb" target="_blank" rel="noopener noreferrer">link<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>è‡ªå®šä¹‰è¾“å‡º</strong><br> Autogen é»˜è®¤å°† Agent å¯¹è¯ä¿¡æ¯è¾“å‡ºåœ¨ç»ˆç«¯ä¸­ã€‚å¦‚æœæƒ³åœ¨å‰ç«¯å±•ç¤ºï¼Œå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ WebSocketIOï¼Œå°†å¯¹è¯ä¿¡æ¯ä»¥ stream çš„å½¢å¼è¾“å‡ºåˆ° UI ç•Œé¢ã€‚</p><h2 id="_4-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_4-æ€»ç»“" aria-hidden="true">#</a> 4. æ€»ç»“</h2><p>Autogen ä½œä¸º Agent æ­å»ºå·¥å…·ï¼Œæä¾›äº†ä¸€äº›åŸºç¡€åŠŸèƒ½ã€‚è™½ç„¶å…¶è®¾è®¡å°†æ‰§è¡Œå·¥å…·ä¸ LLM Agent åˆå¹¶åœ¨ä¸€èµ·ï¼Œä½†è¿™ç§è®¾è®¡åœ¨æŸäº›æƒ…å†µä¸‹å¹¶ä¸ä¼˜é›…ï¼Œå¯ä»¥è€ƒè™‘å°†å‡½æ•°å·¥å…·ä¸ LLM Agent åˆ†å¼€è®¾è®¡ã€‚</p><p>æ­¤å¤– Autogen ä¸­ï¼Œ 2 ä¸ª Agent ä¹‹é—´çš„å¯¹è¯ï¼Œæ˜¯é€šè¿‡é€’å½’å‡½æ•°å®ç°çš„ï¼›Multi-Agent å¯¹è¯æ˜¯é€šè¿‡é‚®å·®ä¼ è¯çš„å½¢å¼å®ç°çš„ã€‚</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 417333277@qq.com">kevinng77</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer"><a href="https://beian.miit.gov.cn/" target="_blank">æ²ªICPå¤‡2023027904å·-1</a>&nbsp;<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=" target="_blank"><img src="/assets/gongan.png">å…¬å®‰å¤‡æ¡ˆå· </a></div><div class="vp-copyright">Copyright Â© 2025 Kevin å´å˜‰æ–‡</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-37c77bc0.js" defer></script>
  </body>
</html>
